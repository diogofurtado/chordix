function UserStorage(){var e=gC("login");return this.base=new BaseLocalStorage("cc-user-"+(null===e?"guest":e)),this}function SongStorage(e,t,s,o){this.userConfig=new UserStorage,this.cifraKey=e+"-"+t+"-"+s+"-"+o,this.userConfigKey="configs"}function SongHash(e){this.base=new BaseHash,this.instrumentSlug=e}!function(e,t,s){"use strict";function o(){this.modal=t("#c-rol"),this.elements={button:t("#side-rolagem"),faster:this.modal.find(".c-vel_max"),slower:this.modal.find(".c-vel_min"),pointer:this.modal.find(".c-vel_p"),play:this.modal.find(".c-rol_play"),close:this.modal.find(".c-mod_close"),expand:this.modal.find(".c-mod_expand")},this.speed={base:120,value:3}}function n(){}function i(){}function a(){this.modal=t("#c-acordes")}function l(){this.modal=t("#c-ver"),this.simplifiedVersionLink=t("#side-simplificar")}function r(){this.elements={modal:t("#c-favorite"),button:t("#side-favoritar"),error:"div.error"},this.elements.close=this.elements.modal.find(".c-mod_close"),this.elements.form=this.elements.modal.find("form"),this.elements.list=this.elements.modal.find("ul"),this.elements.songbookName=this.elements.form.find(".js-songbook_name"),this.cifra={},this.listLoaded=!1}function d(){this.container=t("section.consegui-box"),this.elements={can:this.container.find(".consegui-button").eq(0),cant:this.container.find(".consegui-button.not"),users:this.container.find(".consegui-users")},this.status=this.elements.can.hasClass("off")?"cant":this.elements.cant.hasClass("off")?"can":null,this.cifra={}}function c(){this.icon=t(".titulo").find(".ico_verified"),this.modal=t("#c-verified")}function u(){}function h(t,s,o,n,i){function a(){e.onYouTubeIframeAPIReady=function(){YouTubeAPIReady=!0};var t=document.createElement("script");t.src="https://www.youtube.com/iframe_api";var s=document.getElementsByTagName("script"),o=s[s.length-1];o.parentNode.insertBefore(t,o)}function l(){var t=setInterval(function(){1==e.YouTubeAPIReady&&(clearInterval(t),c.createPlayer())},500)}function r(){var e=(new Date).getTime().toString();c.uniqueId=c.ytVideo?e+c.ytVideo:e}function d(e){"masterPlaying"===e.key&&e.newValue!==c.uniqueId&&c.pause()}var c=this;this.player=null,this.ytVideo="",this.lastYTVideo="",this.lastSentProgress=0,this.setYTVideo(t),this.keys={volume:"playerVolume"+this.constructor.name,times:"playerTime"+this.constructor.name},this.lastStatus=-1,this.repeatVideo=!1,this.alreadyPlayed=!1,this.timeoutEvento=null,this.playedSeconds=[],this.timingTracker=null,("undefined"==typeof n||null===n)&&(n=!0),this.shouldPauseOthers=n,this.options={width:640,height:390,playerVars:{autohide:2,autoplay:1,cc_load_policy:0,color:"red",controls:0,disablekb:1,fs:1,hl:"pt",iv_load_policy:3,loop:0,origin:e.location.origin,start:c.getSavedElapsedTime(c.ytVideo),theme:"dark"}},this.apiURL="https://www.googleapis.com/youtube/v3/",this.apiKey="AIzaSyDXV19VCO_UE1DE2zzkPGTuHS0ScvxdESQ",e.YouTubeAPIReady=e.YouTubeAPIReady||!1,this.setContainerSelector(s||"playerContainer"),this.setOptions(o),l(),a(),"undefined"==typeof h.players&&(h.players=[]),h.players.push(this),r(),e.addEventListener?e.addEventListener("storage",d,!1):e.attachEvent("onstorage",d)}function p(e,s,o){var n=this,s=s||"aula-player",o=o||{};this.elements={player:t("section.aula"),playerStage:t("#"+s),buttonPlayPause:t("button.aula-play"),buttonSeekLess15:t("button.aula-less"),buttonSeekMore15:t("button.aula-more"),buttonMute:t("span.aula-vol button"),buttonConfig:t("button.aula-config"),buttonFullScreen:t("button.aula-full"),labelVideoElapsed:t("span.aula-time .elapsed"),labelVideoLength:t("span.aula-time .total"),labelChapter:t("span.aula-cap_select"),progressSeek:t("div.ap-progress .ap-seek"),progressLoad:t("div.ap-progress .ap-load"),progressPlay:t("div.ap-progress .ap-play"),volumeSlider:t("span.aula-volume-panel .aula-volume-slider"),volumeBar:t("span.aula-volume-panel .aula-volume-slider span"),modalConfig:t("div.aula-mod-config"),modalChapters:t("div.aula-capitulos")},this.timing=null,this.currentChapter=-1,this.repeatChapter=-1,this.dragControl=!1,this.jsPlayer=null,this.boltPlayer=null,11==e.length?h.call(this,e,s,o):7==e.length?(this.ytVideo=e,this.startBoltPlayer()):(this.ytVideo=e,this.startJsPlayer()),this.resetData(),this.bindEvents();var i=setInterval(function(){n.videoInfoLoaded===!0&&(n.startVideoLesson(),clearInterval(i))},500)}function g(e){this.timing=null,this.elements={coverPlaying:{container:t(".cover-info"),labelName:t(".cover-container .cover-info .cover-name"),labelView:t(".cover-container .cover-info .cover-view"),labelDate:t(".cover-container .cover-info .cover-date")},coverList:{container:t(".cover-container ul")},commentsBox:t("#comentarios")},this.setEvents(),this.startCovers();var s=new BaseHash,o=s.get("vct",!1),n=0;if(0!=o)if(o==e)n=1,this.scrollToBox();else{var i=this.searchCover(o);i&&(e=o,n=1,this.scrollToBox())}h.call(this,e,"cover_player",{playerVars:{controls:1,autoplay:n}},null,"Cover")}function m(e,s,o){var n=this;"undefined"==typeof s&&(s=2),this.timing=null,this.basePlayer=null,this.musicName=e,this.videos=[],this.videosDetails=!1,this.videoIndex=0,this.searchData={max:10,nextPageToken:""},this.elements={player:t("#player"),playerStage:"videos-player",cifraContent:t(".cifra_cnt"),inputSearch:t("input.pl_videos_inp")},this.playerSizes={min:{width:230,height:230},normal:{width:355,height:200},max:{width:840,height:480},full:{width:screen.width,height:screen.height-32}},this.lastSize=s,this.actualSize=-1,this.sizeOrder=["closed","min","normal","max","full"],this.volumeSliding=!1,this.dragControl=!1,this.repeatVideo=!1,this.searching=!1,this.searchVideos(function(){n.init()},o)}var f=e.SS||{};f.song={info:{},elements:{videoLessonContainer:t("section.aula"),videoLessonOpenButton:t("#side-video"),videoLessonCloseButton:t(".aula-close"),videoLessonWarning:t(".aula-warning"),videoLessonWarningClose:t(".aula-warning > i"),videoLessonStartButton:t(".aula-freeze > button"),downloadSongButton:t("#js-download_song"),metronomoOpenButton:t("#js-open_metronomo"),videosPlayer:t("#player"),coverInfo:t(".cover-info"),cifraContent:t("div.cifra_cnt pre"),simplifyButton:t("#side-simplificar")},videoLessonPlayer:null,videoLessonId:null,coverPlayer:null,videosPlayer:null,init:function(e){var s,h,p,v=this,y=2;if(this.capo=f.songCore.capo,this.tuning=f.songCore.tuning,this.constants=f.songCore.constants,this.Chord=f.songCore.Chord,this.chordBuilder=f.songCore.chordBuilder,this.chordHandler=f.songCore.chordHandler,this.display=f.songCore.display,this.displayHandler=f.songCore.displayHandler,this.font=f.songCore.font,this.instrument=f.songCore.instrument,this.key=f.songCore.songKey,this.modalHandler=f.songCore.modalHandler,this.noteUtil=f.songCore.noteUtil,this.storage=new SongStorage(e.artistSlug,e.songSlug,e.instrumentId,e.version),this.hash=new SongHash(this.constants.instrumentSlugs[e.instrumentId]),this.scroller=new o,this.chordsUI=new n,this.chordModal=new i,this.sideChords=new a,this.versions=new l,this.songbook=new r,this.canPlay=new d,this.verified=new c,this.dictionaryModal=new u,this.info={artistName:e.artistName,artistSlug:e.artistSlug,songTitle:e.songTitle,songSlug:e.songSlug,songId:e.id_musica,cifraId:e.id_cifra,instrumentId:e.instrumentId},this.modalHandler.init(),this.key.init({originalNote:e.key,callbacks:{requestTranspose:function(){return f.song.chordHandler.retrieveChords()},afterUserTranspose:function(){f.song.chordsUI.updateSongContent(),f.song.storage.set("tone",this.getRealValue()),f.song.hash.set("tone",this.getRealValue())}},constants:f.song.constants,songInfo:f.song.info}),this.instrument.init({value:e.instrumentId,callbacks:{onChange:function(e){if(v.displayHandler.enable({chordsBodyCheck:"keyboard"!==e,tabsCheck:"guitar"===e,leftHandedCheck:"keyboard"!==e}),"guitar"===e||"cavaco"===e){var s=f.song.hash.base.get(f.song.hash.config.bodyChords.hash)===!0,o=f.song.hash.base.get(f.song.hash.config.leftHanded.hash)===!0;v.display.setChordsBody(s),t(f.song.displayHandler.settings.selectors.chordsBodyCheck).prop("checked",s),v.display.setLeftHanded(o),t(f.song.displayHandler.settings.selectors.leftHandedCheck).prop("checked",o)}if("guitar"===e){var n=f.song.hash.base.get(f.song.hash.config.tabs.hash)!==!1;v.capo.enable(),v.capo.reset(!1),v.tuning.enable(),v.tuning.reset(),v.display.setTabs(n),t(f.song.displayHandler.settings.selectors.tabsCheck).prop("checked",n),v.key.settings.invisibleCapoTuning=!1}"keyboard"===e&&v.display.setChordsBody(!1,!1),("cavaco"===e||"keyboard"===e)&&(v.capo.disable(),v.tuning.disable(),v.display.setTabs(!1),v.display.setLeftHanded(!1),v.key.settings.invisibleCapoTuning=!0),v.key.reset(),v.sideChords.displayIfNeeded(),v.versions.updateSimplifiedVersionLink()}}}),this.capo.init({value:e.capo||0,callbacks:{afterConfirmCapo:function(e){f.song.chordsUI.updateChordsHtml(),f.song.chordsUI.buildHeader(),f.song.key.animateLabel(),e!==this.settings.value&&(f.song.storage.set("capo",this.settings.value),f.song.hash.set("capo",this.settings.value),salva_evento(f.song.constants.analytics.category,0===this.settings.value?"remove_capo":"add_capo",this.settings.value.toString()))},afterOpen:function(e,s){t(s).is("#cifra_capo > a")&&t(e).addClass("c-mod_top")},afterClose:function(e){t(e).removeClass("c-mod_top")}}}),this.tuning.init({value:e.tuning,callbacks:{bindEvents:function(){var e=this,s=f.song.info.artistSlug+" - "+f.song.info.songSlug;this.settings.modal.on("open",function(){e.settings.modal.find("select").val(e.settings.value),e.setModalStrings(e.settings.value.split(" ")),e.settings.showTuner&&e.createTuner(),e.settings.callbacks.afterOpen.call(e,this,t(this).data("trigger"))}).on("close",function(){null!==e.settings.tunerUseStart&&salva_evento(f.song.constants.analytics.category,"fechou_afinador",s,parseInt((new Date).getTime()/1e3)-e.settings.tunerUseStart),e.settings.tunerUseStart=null,e.settings.callbacks.afterOpen.call(e,this)}).on("change","select",function(){e.setModalStrings(t(this).val().split(" "))}).on("click",".js-ok",function(){var t,o=["tune_padrao","tune_meiotom","tune_umtom","tune_umtomemeio","tune_doistons"],n=e.settings.value;e.setValue(e.settings.modal.find("select").val()),n!==e.settings.value&&(e.settings.callbacks.afterUserTuning.call(e),t=e.getIndex(),t>-1&&salva_evento(f.song.constants.analytics.category,o[t],s),f.song.storage.set("tuning",e.settings.value),f.song.hash.set("tuning",e.settings.value))}).on("click",".afi-ouvir",function(){e.playString(e.settings.modal.find("select").val(),e.settings.modal.find(".afi-ouvir").index(this)),salva_evento(f.song.constants.analytics.category,"afinacao_play",s)}).on("click",".js-ok, .js-cancel",function(){f.song.modalHandler.close(e.settings.modal,e.settings.modal.data("trigger"))}).on("mouseenter",".js-tunerapp",function(){null===e.settings.tunerUseStart&&(e.settings.tunerUseStart=parseInt((new Date).getTime()/1e3),salva_evento(f.song.constants.analytics.category,"abriu_afinador",s))}),f.song.modalHandler.bindToggle(this.settings.modal,this.settings.mainTrigger,!0)},afterOpen:function(e,s){t(s).is("#cifra_afi > a")&&t(e).addClass("c-mod_top")},afterClose:function(e){t(e).removeClass("c-mod_top")},afterUserTuning:function(){f.song.chordsUI.updateChordsHtml(),f.song.chordsUI.buildHeader(),f.song.key.animateLabel()}}}),this.display.init(),this.scroller.init(),this.displayHandler.init({cifraContent:t("div.cifra_cnt pre").html(),cifraInfo:v.info,constants:this.constants,userPreferences:{hash:f.song.hash,storage:f.song.storage},elements:{modal:t("#c-exibir"),button:t("#side-exibir")},selectors:{columnsCheck:".js-split_cols",chordsBodyCheck:".js-show_chords_body",chordsFooterCheck:".js-show_chords_footer",tabsCheck:".js-toggle_tabs",leftHandedCheck:".js-left_handed",tabs:"span.tablatura",songContainer:"div.cifra_cnt"},callbacks:{onChordsChange:function(){f.song.chordsUI.updateChordsHtml()},onSplitColumnChange:function(e){return e&&2===f.song.videosPlayer.getSize()?void f.song.videosPlayer.setSize(1):void(e||1!==f.song.videosPlayer.getSize()||f.song.videosPlayer.setSize(2))},getOriginalSongContent:function(){return f.song.chordHandler.settings.songCache[f.song.key.settings.value].html}},handlers:{splitColumnsHandler:function(e){f.songCore.font.updateFontSize(e),f.song.hash.resetFontValue(),f.song.displayHandler.splitColumnsHandler(e)}}}),this.chordHandler.init({songUrl:e.apiUrl,chords:e.chords,callbacks:{onTransposeError:function(){f.song.songbook.setMessage("Não foi possível alterar as tablaturas para "+f.song.key.getNote()+".")}}}),this.chordsUI.init({callbacks:{updateSongContent:function(e){t(this.settings.elements.songContainer).find("pre").html(e),f.song.displayHandler.update(),this.updateChordsHtml(),this.buildHeader()},updateChordsHtml:{sidechords:function(){f.song.sideChords.updateChordsHtml()}},afterInstrumentChange:function(){f.song.sideChords.displayIfNeeded(),f.song.chordsUI.updateChordsHtml()}}}),this.chordModal.init(),this.sideChords.init(),this.versions.init(),this.songbook.init({id_cifra:e.id_cifra,id_musica:e.id_musica,tipo:e.instrumentId}),this.canPlay.init({id_cifra:e.id_cifra,id_musica:e.id_musica,tipo:e.instrumentId}),this.verified.init(),this.dictionaryModal.init(),this.font.init({constants:this.constants,elements:{sizeSelectorGroup:t(".js-font"),sizeSelectorReset:t(".js-font").find("li"),sizeSelectorIncrease:t(".js-font-more"),sizeSelectorDecrease:t(".js-font-less"),boldChord:t(".js-chord_bold"),boldText:t(".js-text_bold"),content:t(".cifra_cnt"),sheet:t(".folha")},callbacks:{afterChangeFontSize:function(){f.song.storage.set("font",this.fontSize),f.song.hash.set("font",this.fontSize),f.song.displayHandler.update(),f.song.chordsUI.updateChordsHtml(),f.song.chordsUI.buildHeader()}}}),this.videoLessonId=e.id_video,this.bindEvents(),this.elements.cifraContent.length>0)for(s=this.elements.cifraContent.html().split("\n"),p=0;8>p;p++)h=s[p].replace(/<\/?(.*?)>/gim,""),h.length>55&&(y=1);return this.coverPlayer=new g(t(this.elements.coverInfo).data("video")),this.elements.videosPlayer.length>0&&(this.videosPlayer=new m(this.info.artistName.trim()+" - "+this.info.songTitle.trim(),y,e.songYoutubeId),this.elements.videosPlayer.on("resize",function(e,t){t>2&&f.song.stopVideoLesson()}).on("beforeplay",function(){if(f.song.videoLessonPlayer){var e=f.song.videoLessonPlayer.getPlayStatus();(1===e||-1===e)&&f.song.videoLessonPlayer.freeze()}})),e.otherVersionVideo&&t("body").addClass("aula-other"),this.storage.init(),this.hash.init(),3===this.info.instrumentId&&this.hash.base.get("autoplay")!==!0&&f.song.startVideoLesson(!1),t.getJSON(f.api.tokenUrl,function(s){s.token&&t.ajax({url:f.api.getHitsUrl()+"song"+e.apiUrl,type:"post",dataType:"json",data:{sid:e.id_cifra,tid:e.instrumentId,aid:e.artistId,mid:e.id_musica,h:s.token}})})},bindEvents:function(){var s=this;t(this.elements.videoLessonOpenButton).click(function(){t("body").hasClass("aula-show")?s.stopVideoLesson():s.startVideoLesson(!0)}),t(this.elements.videoLessonCloseButton).click(function(){s.stopVideoLesson()}),this.elements.videoLessonStartButton.on("click",function(){s.elements.videoLessonContainer.removeClass("freeze"),s.startVideoLesson(!0)}),t(this.elements.videoLessonWarningClose).on("click",function(){return t(this).parent().hide(),t("body").removeClass("aula-other"),!1}),t(this.elements.metronomoOpenButton).click(function(){salva_evento("tela_cifras","abriu_metronomo",s.info.artistSlug+" - "+s.info.songSlug)}),t(this.elements.downloadSongButton).on("click",function(){s.downloadSong()}),t(this.elements.simplifyButton).on("click",function(){salva_evento("tela_cifras","simplificar",s.info.artistSlug+" - "+s.info.songSlug)}),t(this.elements.videoLessonWarning).on("click",function(t){t.preventDefault(),f.song.hash.base.get(f.song.hash.config.video.hash)+""=="true"&&s.storage.set("video",!0),e.location.href=this.href}),t("pre").length&&t(document).on("scroll",function(){var o=t("section.aula"),n=t("ul.cifra_acordes").parent(),i=t("#breadcrumb"),a=e.innerHeight+e.pageYOffset-(t("pre")[0].offsetHeight+t("pre:eq(0)").offset().top);t(document).scrollTop()>i[0].offsetHeight+i.offset().top&&!s.elements.videoLessonContainer.hasClass("other-playing")?t("body").addClass("fix-player"):t("body").removeClass("fix-player"),a-t(e).height()+o.height()>0&&!o.hasClass("other-playing")?o.css("position","absolute").css("top",n.offset().top-o.height()-t("#breadcrumb").parent().offset().top-parseInt(t("div.cifra_cnt").css("margin-bottom"),10)):o.removeAttr("style"),f.song.sideChords.handlePosition()})},startVideoLesson:function(e){null!==this.videoLessonId&&""!==this.videoLessonId&&(null!==this.videosPlayer&&this.videosPlayer.getSize()>2&&this.videosPlayer.setSize(2),t("body").addClass("aula-show"),t(this.elements.videoLessonOpenButton).addClass("on"),e?(this.hash.set("video",!0),null===this.videoLessonPlayer?this.videoLessonPlayer=new p(this.videoLessonId,null):this.videoLessonPlayer.play()):this.elements.videoLessonContainer.addClass("freeze"),salva_evento("Player_Videoaula","Abriu",f.song.info.artistName+" - "+f.song.info.songTitle))},stopVideoLesson:function(){t("body").hasClass("aula-show")&&(t("body").removeClass("aula-show"),t(this.elements.videoLessonOpenButton).removeClass("on"),salva_evento("Player_Videoaula","Fechou",f.song.info.artistName+" - "+f.song.info.songTitle)),this.hash.set("video",!1),this.videoLessonPlayer&&"object"==typeof this.videoLessonPlayer&&this.videoLessonPlayer.pause()},downloadSong:function(){var e,s="",o=this.instrument.settings.value,n=this.chordHandler.settings.chords,i=this.capo.settings.value,a=i-this.tuning.getIndex(),l=["guitar","cavaco"];if(s+=this.info.artistName+" - "+this.info.songTitle+"\n\n",s+=t(".cifra_cnt > pre").text()+"\n\n",-1!==l.indexOf(o)){s+="----------------- Acordes -----------------\n",0!==i&&(s+="Capotraste na "+i+"ª casa\n");for(var r=0;r<n.length;r++)e=n[r].defaultMountIndex[o],s+=n[r].name+(0!==a?"* ":"")+" = "+n[r].mounts[o][e],0!==a&&(s+=" - (*"+this.noteUtil.getTransposedChord(n[r].name,a)+" na forma de "+n[r].name+")"),s+="\n"}return t.download(f.ajax.URL+"salva_txt.php",{txt:s,nome:this.info.songTitle}),!1}},o.prototype.init=function(){var s,o=this,n=function(e){clearTimeout(s),s=setTimeout(function(){salva_evento("tela_cifras","autoscroll_speed",e,o.speed.value)},5e3)};f.song.modalHandler.addTrigger(this.elements.button),this.elements.button.on("click",function(){o.modal.is(":visible")?(o.close(),salva_evento("tela_cifras","autoscroll_close","click")):(o.open(),salva_evento("tela_cifras","autoscroll_open","click"))}),this.elements.play.on("click",function(){return o.elements.play.hasClass("c-rol_pause")?(o.stop(),void salva_evento("tela_cifras","autoscroll_pause","click")):(o.start(),void salva_evento("tela_cifras","autoscroll_play","click"))}),this.elements.close.on("click",function(){o.close(),salva_evento("tela_cifras","autoscroll_close","click")}),this.elements.slower.on("click",function(){o.shift(-1),n("click")}),this.elements.faster.on("click",function(){o.shift(1),n("click")}),this.elements.expand.on("click",function(){o.modal.toggleClass("open")}),t(document).on("keydown",function(s){if(o.modal.is(":visible")&&t("input, textarea").is(":focus")===!1){var i=!0;switch(s.keyCode){case 27:o.close(),i=!1,salva_evento("tela_cifras","autoscroll_close","keydown");break;case 32:o.elements.play.hasClass("c-rol_pause")?(o.stop(),salva_evento("tela_cifras","autoscroll_pause","keydown")):(o.start(),salva_evento("tela_cifras","autoscroll_play","keydown")),i=!1;break;case 37:o.shift(-1),i=!1,n("keydown");break;case 38:t(e).scrollTo(t(document).scrollTop()-200,100),i=!1;break;case 39:o.shift(1),i=!1,n("keydown");break;case 40:t(e).scrollTo(t(document).scrollTop()+200,100),i=!1}i===!1&&stopPropagation(s)}})},o.prototype.pageScroll=function(){var s=this,o=e.pageYOffset,n=t("pre")[0].offsetHeight-200;f.IS_IPAD?setTimeout(function(){e.scrollTo(e.pageXOffset,o+2)},1):e.scrollBy(0,1),o>=n?this.stop():this.scrolldelay=setTimeout(function(){s.pageScroll()},s.speed.base/s.speed.value)},o.prototype.open=function(){this.modal.addClass("on"),this.modal.css("left",this.elements.button.offset().left),this.start()},o.prototype.close=function(){this.stop(),this.modal.removeClass("on")},o.prototype.start=function(){this.pageScroll(),this.elements.play.addClass("c-rol_pause")},o.prototype.stop=function(){var e=this;clearTimeout(this.scrolldelay),setTimeout(function(){e.elements.play.removeClass("c-rol_pause")},80)},o.prototype.shift=function(e){-1==t.inArray(this.speed.value+e,[0,6])&&(this.elements.pointer.removeClass("n"+this.speed.value),this.speed.value+=e,this.elements.pointer.addClass("n"+this.speed.value))},n.prototype.settings={elements:{songContainer:t(".cifra_cnt"),chordsFooter:t(".cifra_acordes")},dataKeys:{customMountIndex:"mount_index"},callbacks:{updateChordsHtml:{footer:function(){var e,t,s=f.song.chordHandler.settings.chords,o=f.song.instrument.settings.value;if(this.settings.elements.chordsFooter.empty(),f.song.display.settings.chordsFooter)for(t in s)e=s[t].defaultMountIndex[o],f.song.chordHandler.chordHasMount(t,e)&&this.settings.elements.chordsFooter.append("<li>"+f.song.chordBuilder.getChordHtml(this.getChordBuilderOptions(t,e,!1))+"</li>")},body:function(){var e,s,o,n,i=this.settings.elements.songContainer.find("pre"),a=i.find("b"),l=f.song.instrument.settings.value;if(i.find(".ac-acorde_p").remove(),f.song.display.settings.chordsBody)for(a.hide(),e=0;e<a.length;e++)s=f.song.chordHandler.getChordIndex(a.eq(e).text()),o=a.eq(e).data(this.settings.dataKeys.customMountIndex),isNaN(o)&&(o=f.song.chordHandler.settings.chords[s].defaultMountIndex[l]),f.song.chordHandler.chordHasMount(s,o)&&(n=f.song.chordBuilder.getChordHtml(this.getChordBuilderOptions(s,o,!0)),t(n).insertAfter(a[e]));else a.show()}},updateSongContent:function(e){},afterInstrumentChange:function(){}}},n.prototype.getChordBuilderOptions=function(e,t,s){return{instrument:f.song.instrument.settings.value,chordName:f.song.chordHandler.settings.chords[e].name,mount:f.song.chordHandler.settings.chords[e].mounts[f.song.instrument.settings.value][t],fingers:f.song.chordHandler.getFingersFor(e,t),capo:f.song.capo.settings.value,tuning:f.song.tuning.settings.value,leftHanded:f.song.display.settings.leftHanded,mini:s}},n.prototype.buildHeader=function(){if(!f.songCore.instrument.isCifraGroup())return!1;var e,s=(f.song.constants.notesSharp,0),o=f.song.key.getNote(),n={"#cifra_tom > a":f.song.key.settings.modal,"#cifra_afi > a":f.song.tuning.settings.modal,"#cifra_capo > a":f.song.capo.settings.modal};f.song.capo.settings.enabled&&(s=f.song.capo.settings.value),f.song.tuning.settings.enabled&&(s-=f.song.tuning.getIndex()),e=f.song.noteUtil.getTransposedNote(o,s),t("#cifra_tom").html('Tom: <a title="alterar o tom da cifra">'+e+"</a>"+(e!==o?" (com acordes na forma de  "+o+")":"")),t("#cifra_afi").html("E A D G B E"!==f.song.tuning.settings.value&&f.song.tuning.settings.enabled?'Afinação: <a title="alterar o tom da cifra">'+f.song.tuning.settings.value+"</a>":""),t("#cifra_capo").html(0!==f.song.capo.settings.value&&f.song.tuning.settings.enabled?'Capotraste na <a title="alterar capotraste">'+f.song.capo.settings.value+"ª casa</a>":"");for(var i in n)f.song.modalHandler.bindToggle(n[i],t(i),!0);f.songCore.songKey.markModalKey()},n.prototype.updateChordsHtml=function(){for(var e in this.settings.callbacks.updateChordsHtml)this.settings.callbacks.updateChordsHtml[e].call(this)},n.prototype.updateSongContent=function(){var e=f.song.chordHandler.settings.songCache[f.song.key.settings.value].html;this.settings.callbacks.updateSongContent.call(this,e)},n.prototype.setInstrument=function(e){var t=this,s=f.song.capo.settings.originalValue-f.song.constants.tuningStrings.indexOf(f.song.tuning.settings.originalValue),o=0,n="E A D G B E";f.song.instrument.setValue(e),"guitar"===f.song.instrument.settings.value&&(o=f.song.capo.settings.originalValue,n=f.song.tuning.settings.originalValue),f.song.capo.setValue(o),f.song.tuning.setValue(n),f.song.key.setValue("guitar"===f.song.instrument.settings.value?0:s).done(function(){t.updateSongContent()}),this.settings.callbacks.afterInstrumentChange.call(this)},n.prototype.init=function(e){t.extend(!0,this.settings,e),this.buildHeader(),this.updateChordsHtml()},i.prototype.settings={timeoutId:null,nextCloneNumber:2,elements:{mainModal:t("#c-troca")},selectors:{mainChord:".c-troca_ac .ac-acorde",draggingBar:".c-troca.ui-draggable",variationList:".c-tr_lista ul"},dataKeys:{modalTrigger:"trigger",originalMainChord:"mainChord_original_element"}},i.prototype.getSelectedMount=function(e,t){var s,o;return e.is(this.settings.elements.mainModal)?(s=e.data(this.settings.dataKeys.modalTrigger),isNaN(s.data(f.song.chordsUI.settings.dataKeys.customMountIndex))?("undefined"==typeof t&&(o=f.song.chordBuilder.getChordName(e.find(this.settings.selectors.mainChord)),t=f.song.chordHandler.getChordIndex(o)),f.song.chordHandler.settings.chords[t].defaultMountIndex[f.song.instrument.settings.value]):s.data(f.song.chordsUI.settings.dataKeys.customMountIndex)):isNaN(e.data(f.song.chordsUI.settings.dataKeys.customMountIndex))?0:e.data(f.song.chordsUI.settings.dataKeys.customMountIndex)},i.prototype.storeSelectedMount=function(e){var t,s=e.find(this.settings.selectors.variationList+" li"),o=s.index(s.filter(".on"));return e.is(this.settings.elements.mainModal)?(t=e.data(this.settings.dataKeys.modalTrigger),void t.data(f.song.chordsUI.settings.dataKeys.customMountIndex,o)):void e.data(f.song.chordsUI.settings.dataKeys.customMountIndex,o)},i.prototype.markSelectedMount=function(e){e.find(this.settings.selectors.variationList+" li").removeClass("on").eq(this.getSelectedMount(e)).addClass("on")},i.prototype.cleanLinksHovers=function(){f.song.chordsUI.settings.elements.songContainer.find("pre b.hover").removeClass("hover")},i.prototype.setupMainModal=function(e,t){var s,o=f.song.chordHandler.getChordIndex(e),n=f.song.instrument.settings.value,i=f.song.capo.settings.value,a=i-f.song.tuning.getIndex(),l="on";return clearTimeout(this.settings.timeoutId),this.cleanLinksHovers(),this.settings.elements.mainModal.removeClass("on open c-troca_capo c-mod_bottom c-troca_tec").data(this.settings.dataKeys.modalTrigger,t),s=this.getSelectedMount(this.settings.elements.mainModal,o),f.song.chordHandler.chordHasMount(o,s)?("keyboard"===n&&(l+=" c-troca_tec"),(i>0||0!==a)&&"guitar"===n&&(l+=" c-troca_capo"),this.settings.elements.mainModal.addClass(l).find(this.settings.selectors.mainChord).replaceWith(f.song.chordBuilder.getChordHtml(f.song.chordsUI.getChordBuilderOptions(o,s,!1))),!0):!1},i.prototype.autoHideMainModal=function(){var e=this;this.settings.timeoutId=setTimeout(function(){e.settings.elements.mainModal.hasClass("open")||(e.settings.elements.mainModal.removeClass("on"),e.cleanLinksHovers())},700)},i.prototype.showModalOverLink=function(s){var o,n=s.text();this.setupMainModal(n,s),s.addClass("hover"),o=s.outerWidth(),this.settings.elements.mainModal.find(".after").css("width",o).css("left",this.settings.elements.mainModal.outerWidth()/2-o/2),f.song.modalHandler.addTrigger(s),this.settings.elements.mainModal.addClass("c-mod_bottom").css("bottom",t(e).height()-s.offset().top+6).css("left",s.offset().left-this.settings.elements.mainModal.outerWidth()/2+o/2)},i.prototype.showModalAtChord=function(s){var o;this.setupMainModal(f.song.chordBuilder.getChordName(s),s),o=this.settings.elements.mainModal.find(this.settings.selectors.mainChord),this.settings.elements.mainModal.css({bottom:t(e).height()-s.offset().top-this.settings.elements.mainModal.height()+o.offset().top-this.settings.elements.mainModal.offset().top-2,left:s.offset().left-(o.offset().left-this.settings.elements.mainModal.offset().left)})},i.prototype.pinClone=function(){var e=this.settings.elements.mainModal.clone(),t=this.getSelectedMount(this.settings.elements.mainModal);return e.data(f.song.chordsUI.settings.dataKeys.customMountIndex,t).removeClass("ui-draggable-dragging").addClass("no-border c-mod_pin").attr("id","c-troca"+this.settings.nextCloneNumber).css("top",this.settings.elements.mainModal.offset().top).css("left",this.settings.elements.mainModal.offset().left).appendTo(this.settings.elements.mainModal.parent()).find(".c-mod_mov").after('<button class="c-mod_close"></button>'),e.find(".after").remove(),this.settings.elements.mainModal.removeClass("on"),this.cleanLinksHovers(),e.find(".js-change_check").removeAttr("id"),this.createVariationListFor(e),this.markSelectedMount(e),this.bindCloneEvents(e),this.settings.nextCloneNumber++,e},i.prototype.createVariationListFor=function(e){var t,s=f.song.chordBuilder.getChordName(e.find(this.settings.selectors.mainChord)),o=f.song.chordHandler.getChordIndex(s),n=f.song.instrument.settings.value,i=f.song.chordHandler.settings.chords,a=e.find(this.settings.selectors.variationList);a.empty();for(t in i[o].mounts[n])a.append("<li>"+f.song.chordBuilder.getChordHtml(f.song.chordsUI.getChordBuilderOptions(o,t,!1))+"</li>");e.find(".js-change_check").siblings("label").find("b").text(s)},i.prototype.toggleVariationList=function(e){var t=e.find(this.settings.selectors.variationList);return e.hasClass("open")?void this.closeVariationList(e):(e.is(this.settings.elements.mainModal)&&this.createVariationListFor(e),this.markSelectedMount(e),t.css("left",0),e.addClass("open"),e.find(".js-prev").addClass("off"),t.width()>t.parent().width()?e.find(".js-next").removeClass("off"):e.find(".js-next").addClass("off"),void e.data(this.settings.dataKeys.originalMainChord,!1))},i.prototype.closeVariationList=function(e,t){e.removeClass("open"),!t&&e.data(this.settings.dataKeys.originalMainChord)&&e.find(this.settings.selectors.mainChord).replaceWith(e.data(this.settings.dataKeys.originalMainChord))},i.prototype.slideVariationList=function(e,t){var s,o=e.find(this.settings.selectors.variationList),n=o.find("li").first().outerWidth(!0),i=o.find("li").length,a=!1;if(!o.is(":animated"))return s=parseInt(o.css("left"))>>0,o.animate({left:t+"="+n+"px"},"fast"),"-"===t&&(a=i*n-o.parent().width()+s<=n),"+"===t&&(a=s===-n),a},i.prototype.bindInitialEvents=function(){var e=this;this.settings.elements.mainModal.draggable({handle:e.settings.selectors.draggingBar}).on({dragstart:function(){t(this).removeClass("c-mod_bottom")},dragstop:function(){var s=e.pinClone(),o=s.find(e.settings.selectors.mainChord);t(this).css("top","auto"),salva_evento("tela_cifras","acordes_moveu",f.song.chordBuilder.getChordName(o))},mouseenter:function(){clearTimeout(e.settings.timeoutId)},mouseleave:function(){e.autoHideMainModal()}}).on("click",".js-toggle_variations",function(){e.toggleVariationList(e.settings.elements.mainModal)}).on("click",".ac-play",function(){var e=t(this).closest(".ac-acorde"),s=f.song.chordBuilder.getChordInfo(e);f.song.noteUtil.playSound(f.song.instrument.settings.value,s.mount,null,s.capo,s.tuning),salva_evento("tela_cifras","acordes_ouvir",s.name)}).on("click",".c-mod_close",function(){e.settings.elements.mainModal.removeClass("on")}),this.bindVariationListEvents(this.settings.elements.mainModal),f.song.chordsUI.settings.elements.songContainer.on({mouseenter:function(){e.showModalOverLink(t(this)),t(this).addClass("hover")},mouseleave:function(){e.autoHideMainModal()},click:function(){}},"b"),f.song.chordsUI.settings.elements.chordsFooter.on({mouseenter:function(){e.showModalAtChord(t(this))}},".ac-acorde")},i.prototype.bindCloneEvents=function(e){var s=this;e.draggable({handle:s.settings.selectors.draggingBar}).on({mouseenter:function(){t(this).removeClass("no-border")},mouseleave:function(){t(this).hasClass("open")||t(this).addClass("no-border")}}).on("click",".c-mod_close",function(){var t=e.find(s.settings.selectors.mainChord);e.removeClass("on"),salva_evento("tela_cifras","acordes_fechar",f.song.chordBuilder.getChordName(t))}).on("click",".js-toggle_variations",function(){s.toggleVariationList(e)}).on("click",".ac-play",function(){var e=t(this).closest(".ac-acorde"),s=f.song.chordBuilder.getChordInfo(e);f.song.noteUtil.playSound(f.song.instrument.settings.value,s.mount,null,s.capo,s.tuning),
salva_evento("tela_cifras","acordes_ouvir",s.name)}),this.bindVariationListEvents(e)},i.prototype.bindVariationListEvents=function(e){var s=this,o=e.find(this.settings.selectors.variationList);e.on("click",this.settings.selectors.variationList+"> li",function(){var o=e.find(s.settings.selectors.mainChord);t(this).hasClass("on")||(e.data(s.settings.dataKeys.originalMainChord)||e.data(s.settings.dataKeys.originalMainChord,o.clone()),o.replaceWith(t(this).find(".ac-acorde").clone()),t(this).parent().find("li").removeClass("on"),t(this).addClass("on"))}).on("click",".js-ok",function(){var t=o.find("li"),n=t.index(t.filter(".on")),i=f.song.chordBuilder.getChordName(e.find(s.settings.selectors.mainChord));e.find(".js-change_check").prop("checked")?(f.song.chordHandler.setDefaultMount(f.song.chordHandler.getChordIndex(i),n),f.song.chordsUI.updateChordsHtml()):s.storeSelectedMount(e),s.closeVariationList(e,!0),salva_evento("tela_cifras","acordes_variar",i,n)}).on("click",".js-cancel",function(){s.closeVariationList(e)}).on("click",".js-prev, .js-next",function(){var o,n=t(this).hasClass("js-prev");t(this).hasClass("off")||(o=s.slideVariationList(e,n?"+":"-"),o&&t(this).addClass("off"),t(this).siblings(".js-next.off, .js-prev.off").removeClass("off"))})},i.prototype.init=function(e){t.extend(!0,this.settings,e),this.bindInitialEvents()},a.prototype.settings={modalSpacing:14,followingScroll:!0},a.prototype.bindEvents=function(){var e=this,s=t("#player");this.modal.on("click",".c-mod_expand",function(){var t;e.modal.toggleClass("open"),t=e.modal.hasClass("open"),e.setFullIfNeeded(),e.settings.followingScroll===!1&&e.modal.css("height",t?e.getMaxHeight():0),salva_evento("tela_cifras",t?"acordes_lateral_on":"acordes_lateral_off",f.song.info.artistSlug+" - "+f.song.info.songSlug)}).on("click",".ac-close",function(){var e=t(this).closest(".ac-acorde");e.hide(),salva_evento("tela_cifras","acordes_lateral_fechou_acorde",f.song.chordBuilder.getChordName(e))}).on("click",".ac-play",function(){var e=t(this).closest(".ac-acorde"),s=f.song.instrument.settings.value,o=f.song.chordBuilder.getChordInfo(e);f.song.noteUtil.playSound(s,o.mount,null,o.capo,o.tuning),salva_evento("tela_cifras","acordes_ouvir",o.name)}).on("mousedown",".c-mod_resize",function(s){var o=s.clientX-e.modal.offset().left,n=e.modal.find(".ac-acorde").first().outerWidth(!0)+14;s.preventDefault(),t("body").css("cursor","w-resize"),t(document).on({"mousemove.chordlistmodal":function(t){var s=e.modal.width()+o-(t.clientX-e.modal.offset().left);t.preventDefault(),s>=n&&(e.modal.width(e.modal.width()+o-(t.clientX-e.modal.offset().left)),e.setFullIfNeeded())},"mouseup.chordlistmodal":function(){t(document).off(".chordlistmodal"),t("body").css("cursor","")}})}).find(".c-mod_cnt").perfectScrollbar(),s.on("resize",function(t,s){return e.modal.removeClass("up up-two"),e.setFullIfNeeded(),0===s?void e.modal.addClass("up-two"):void(1===s&&e.modal.addClass("up"))})},a.prototype.displayIfNeeded=function(){return"keyboard"===f.song.instrument.settings.value?this.modal.addClass("keyboard"):this.modal.removeClass("keyboard"),f.song.chordHandler.instrumentHasMounts()?(this.modal.removeClass("open").addClass("on").css("width",""),void this.handlePosition()):void this.modal.removeClass("on")},a.prototype.setFullIfNeeded=function(){var s=this.modal.find(".js-list").outerHeight()+2*this.settings.modalSpacing+(this.modal.outerHeight()-this.modal.height()),o=t(".player.pl--min");s+(o.length?o.height():0)>e.innerHeight?this.modal.addClass("full"):this.modal.removeClass("full")},a.prototype.handlePosition=function(){var s,o=t(".cifra_cnt"),n=t(".player.pl--min"),i=this.modal.offset().top+this.modal.height();return!this.settings.followingScroll&&(e.innerHeight+e.pageYOffset<=i+2*this.settings.modalSpacing||n.length&&n.offset().top<=i+2*this.settings.modalSpacing)?(this.settings.followingScroll=!0,this.modal.css("height","").css("top","").css("position","").css("bottom",""),void this.setFullIfNeeded()):(s=o.offset().top+o.height(),void(i>=s&&(this.settings.followingScroll=!1,this.modal.css("height",this.modal.hasClass("open")?this.getMaxHeight():0).css("position","absolute").css("bottom",e.innerHeight-s).css("top","auto"))))},a.prototype.getMaxHeight=function(){return this.modal.hasClass("full")?e.innerHeight-(this.modal.outerHeight()-this.modal.height()+2*this.settings.modalSpacing):this.modal.find(".js-list").outerHeight()},a.prototype.updateChordsHtml=function(){var e,s,o,n=this.modal.find(".js-list"),i=f.song.instrument.settings.value;n.empty();for(e in f.song.chordHandler.settings.chords)s=f.song.chordHandler.settings.chords[e].defaultMountIndex[i],f.song.chordHandler.chordHasMount(e,s)&&(o=f.song.chordBuilder.getChordHtml(f.song.chordsUI.getChordBuilderOptions(e,s,!1)),o=t(o).append("<button class=ac-close></button>"),n.append(o));this.setFullIfNeeded()},a.prototype.init=function(){this.updateChordsHtml(),this.displayIfNeeded(),this.bindEvents()},l.prototype.listSelectors={guitar:".c-ver_vio","electric-guitar":".c-ver_gui",cavaco:".c-ver_cav",keyboard:".c-ver_key",bass:".c-ver_bas",drums:".c-ver_dru",harmonica:".c-ver_har",guitarpro:".c-ver_gp",sheet:".c-ver_sht",versionsList:".c-ver_list"},l.prototype.bindEvents=function(){var e=this.modal.find(".c-ver_inst li a"),s=this.modal.find(this.listSelectors.versionsList),o=s.find("li"),n=t(".titulo"),i=this;return e.on("click",function(){var o=t(this).data("instrument"),n=i.listSelectors[o];e.add(s).removeClass("on"),t(this).addClass("on"),s.filter(n).addClass("on").find(".scroll").scrollTop(0)}),o.on("click","a",function(){var e=i.modal.find(".c-ver_inst li a.on").data("instrument");o.removeClass("on"),t(this).parent().addClass("on"),f.song.modalHandler.close(t("#c-ver"),t("#js-openversions")),i.setSelectedInstrument(e),f.song.hash.set("instrument",e),f.song.hash.set("capo",0),f.song.hash.set("tone",0),f.song.hash.set("tuning",0);var s=t(this).attr("href"),n=s.indexOf("#");return n>=0&&(s=s.substr(0,n)),document.location.pathname==s?!1:void(f.song.hash.base.get(f.song.hash.config.video.hash)+""=="true"&&f.song.storage.set("video",!0))}),s.find(".js-reset-order").on("click",function(){var e=t('.c-ver_list[class*="on"]'),s=e.children("ul"),o=s.children("li").get();e.find(".filter-order").find("span").removeClass("order_decrease").removeClass("order_increase"),o.sort(function(e,s){return t(e).data("order")<t(s).data("order")?-1:t(e).data("order")>t(s).data("order")?1:0}),s.html(""),t.each(o,function(e,t){s.append(t)})}),s.find(".js-order-difficulty").on("click",function(){i.filter(t(this),"difficulty")}),s.find(".js-order-hits").on("click",function(){i.filter(t(this),"hits")}),s.find(".scroll").perfectScrollbar(),f.song.modalHandler.bindToggle(t("#c-ver"),t("#js-openversions"),!0),f.song.modalHandler.addTrigger(n),n.on("click",function(){f.song.modalHandler.toggle(t("#c-ver"),t("#js-openversions"),!0)}),this.modal.on("open",function(){salva_evento("tela_cifras","mais_versoes",f.song.info.artistSlug+" - "+f.song.info.songSlug)}),this},l.prototype.setSelectedInstrument=function(e){var s,o=this.modal.find(".c-ver_list"),n=this.modal.find(".c-ver_inst li a"),i=o.filter(this.listSelectors[e]);return o.add(n).removeClass("on"),n.filter("[data-instrument="+e+"]").add(i).addClass("on"),s=i.find("li.on .c-ver_a strong").text(),t(".cifra_label").html(this.translateInstrumentName(e)+": "+s),f.song.instrument.setValue(e),f.song.chordsUI.buildHeader(),f.song.chordsUI.updateChordsHtml(),f.song.instrument.isCifraGroup()&&salva_evento("tela_cifras","acordes_"+this.getInstrumentSlug(e),f.song.info.artistSlug+" - "+f.song.info.songSlug),this},l.prototype.translateInstrumentName=function(e){var t=this.getInstrumentSlug(e),s={violao:"Violão",guitarra:"Guitarra",cavaco:"Cavaquinho",teclado:"Teclado"};return s[t]},l.prototype.getInstrumentSlug=function(e){var t={guitar:"violao","electric-guitar":"guitarra",cavaco:"cavaco",keyboard:"teclado"};return e in t?t[e]:t.guitar},l.prototype.filter=function(e,s){var o,n=t('.c-ver_list[class*="on"]'),i=n.children("ul"),a=i.children("li").get(),l=e.find("span");if(n.find(".filter-order").not(e).find("span").removeClass("order_decrease").removeClass("order_increase"),l.hasClass("order_decrease")?(l.removeClass("order_decrease").addClass("order_increase"),o=-1):l.hasClass("order_increase")?(l.removeClass("order_increase"),o=0):(l.addClass("order_decrease"),o=1),0===o)a.sort(function(e,s){return t(e).data("order")<t(s).data("order")?-1:t(e).data("order")>t(s).data("order")?1:0});else{var r=function(e,t){return 1===o?e>t?-1:t>e?1:0:t>e?-1:e>t?1:0};switch(s){case"difficulty":var d=["iniciante","fácil","intermediário","difícil","muito difícil"];a.sort(function(e,s){var o=d.indexOf(t(e).find(".js-difficulty").text()),n=d.indexOf(t(s).find(".js-difficulty").text());return r(o,n)});break;case"hits":a.sort(function(e,s){var o=parseInt(t(e).find(".js-hits").text().replace(/\./g,"")),n=parseInt(t(s).find(".js-hits").text().replace(/\./g,""));return r(o,n)})}}i.html(""),t.each(a,function(e,t){i.append(t)})},l.prototype.updateSimplifiedVersionLink=function(){var e=f.song.instrument.settings.value,t="";0!==this.simplifiedVersionLink.length&&(("keyboard"===e||"cavaco"===e)&&(t="#instrument="+e),this.simplifiedVersionLink.attr("href",this.simplifiedVersionLink.attr("href").replace(/$|(#.*)/,t)))},l.prototype.init=function(){return this.bindEvents(),this},r.prototype.init=function(e){t.extend(this.cifra,e),this.bindEvents()},r.prototype.bindEvents=function(){var e=this;this.elements.button.on("click",function(){return e.elements.modal.is(":visible")?e.close():(salva_evento("tela_cifras","songbook_abriu_modal",f.song.info.artistSlug+" - "+f.song.info.songSlug),e.open()),!1}),this.elements.close.on("click",function(){e.close()}),this.elements.modal.find(".scroll").perfectScrollbar(),this.elements.list.on("change","input",function(){var s=t(this);return s.prop("checked")?(e.save(s),salva_evento("tela_cifras","songbook_adicionou",f.song.info.artistSlug+" - "+f.song.info.songSlug)):(salva_evento("tela_cifras","songbook_removeu",f.song.info.artistSlug+" - "+f.song.info.songSlug),e.remove(s)),!1}),this.elements.form.submit(function(t){return salva_evento("tela_cifras","songbook_criou_pasta",f.song.info.artistSlug+" - "+f.song.info.songSlug),e.createAndSaveSong(),!1}),f.song.modalHandler.addTrigger(this.elements.button)},r.prototype.open=function(){var e=this,t="Erro ao obter dados de login";return f.cifraclub.ccidbar.isReady()?void f.cifraclub.ccidbar.doLogged(function(){e.listLoaded||e.loadList(),f.song.modalHandler.open(e.elements.modal,e.elements.button,!0)},{selector:this.elements.button,position:"top left"}):(f.util.setMessage(t),!1)},r.prototype.close=function(){this.elements.modal.removeClass("on")},r.prototype.loadList=function(){var e,t=this;e=function(e){var s,o=e.favorites,n='<li><span class="inp_opt"><input '+(o.adicionada?"checked":"")+' type="checkbox" id="favoritos" value="favoritos" ><label for="favoritos">Favoritas ('+o.num_cifras+")</label></span></li>";for(e=e.songbooks,s=0;s<e.length;s++)n+='<li><span class="inp_opt"><input data-song="'+e[s].adicionada+'" '+(e[s].adicionada?"checked":"")+' type="checkbox" id="sb_'+e[s].id+'" value="'+e[s].id+'" ><label for="sb_'+e[s].id+'">'+e[s].nome+" ("+e[s].num_cifras+")</label></span></li>";t.elements.list.append(n),t.listLoaded=!0},f.songbooks.getUserSongbooksBySong(this.cifra.id_cifra,this.cifra.tipo).then(e)},r.prototype.save=function(e){var t,s,o=e.val(),n=e.siblings("label"),i=n.text();t="favoritos"!==o?{id_cifra:this.cifra.id_cifra,song_id:this.cifra.id_musica,type:this.cifra.tipo}:{sid:this.cifra.id_cifra,mid:this.cifra.id_musica,tid:this.cifra.tipo,uid:f.cifraclub.ccidbar.getUser().id},f.songbooks.saveSong(o,t,!1).then(function(t){var s=/\(([^)]+)\)/,a=s.exec(i)[1];e.prop("checked",!0),n.text(i.replace(a,parseInt(a,10)+1)),"favoritos"!==o&&e.data("song",t.id)}).fail(function(e,t,n){if(salva_evento("tela_cifras","songbook_falha_adicionar",f.song.info.artistSlug+" - "+f.song.info.songSlug),"favoritos"!==o){switch(n.toLowerCase()){case"too many songs on songbook":s="Esta lista já alcançou o limite de 100 músicas.";break;case"song already exists in songbook":s="Você já adicionou esta música nesta lista";break;default:s="Erro inesperado."}f.util.setMessage(s)}})},r.prototype.remove=function(e){var t=e.val(),s=e.siblings("label"),o=s.text();f.songbooks.removeSong(t,"favoritos"!==t?e.data("song"):this.cifra.id_cifra,this.cifra.tipo,!1).then(function(){var t=/\(([^)]+)\)/,n=t.exec(o)[1];e.prop("checked",!1),s.text(o.replace(n,parseInt(n,10)-1))})},r.prototype.createAndSaveSong=function(){var e,s,o,n=this,i=this.elements.songbookName.val(),a=this.elements.modal.find(".scroll");e={songbook:i,id_cifra:this.cifra.id_cifra,song_id:this.cifra.id_musica,type:this.cifra.tipo},f.songbooks.createAndSaveSong(e).then(function(e){var s=e.sid;o=t('<li><span class="inp_opt"><input checked type="checkbox" id="sb_'+s+'" value="'+s+'" ><label for="sb_'+s+'">'+i+" (1)</label></span></li>"),n.elements.list.find("li").eq(0).after(o),a.scrollTop(0).perfectScrollbar("update"),n.elements.songbookName.val("")}).fail(function(e,t,o){switch(salva_evento("tela_cifras","songbook_falha_criar_pasta",f.song.info.artistSlug+" - "+f.song.info.songSlug),o.toLowerCase()){case"too many songbooks":s="Você já possui muitas listas.";break;case"too many empty songbooks":s="Você já possui muitas listas vazias.";break;case"songbook already exists":s="Já existe uma lista com esse nome.";break;case"songbook must have a name":s="Sua lista deve conter um nome.";break;case"songbook name too long":s="O nome da lista está grande demais.";break;default:s="Erro inesperado."}f.util.setMessage(s)})},r.prototype.createSongbook=function(e){var s,o,n=this.elements.modal.find(".scroll"),i=this,a=this.elements.songbookName.val();return a.length?(f.songbooks.saveSongbook(a).then(function(e){s=t('<li><span class="inp_opt"><input checked type="checkbox" id="sb_'+e.sid+'" value="'+e.sid+'" ><label for="sb_'+e.sid+'">'+a+" (0)</label></span></li>"),i.elements.list.find("li").eq(0).after(s),n.scrollTop(0).perfectScrollbar("update"),i.save(s.find("input")),i.elements.songbookName.val("")}).fail(function(e,t,s){switch(salva_evento("tela_cifras","songbook_falha_criar_pasta",f.song.info.artistSlug+" - "+f.song.info.songSlug),s.toLowerCase()){case"too many songbooks":o="Você já possui muitas listas.";break;case"too many empty songbooks":o="Você já possui muitas listas vazias.";break;case"songbook already exists":o="Já existe uma lista com esse nome.";break;case"songbook must have a name":o="Sua lista deve conter um nome.";break;case"songbook name too long":o="O nome da lista está grande demais.";break;default:o="Erro inesperado."}f.util.setMessage(o)}),!1):(f.util.setMessage("Sua pasta de música precisa ter um nome"),!1)},r.prototype.setMessage=function(e){var s=t(this.elements.error);s.addClass("on"),s.find("span").html(e),s.on("click",function(){s.removeClass("on")}),setTimeout(function(){s.removeClass("on")},5e3)},d.prototype.init=function(e){var s=this,o="Erro ao obter dados de login";t.extend(this.cifra,e),this.elements.can.on("click",function(){return f.cifraclub.ccidbar.isReady()?(f.cifraclub.ccidbar.doLogged(function(){s.save("can")},{selector:s.elements.can,position:"top left"}),!1):(f.util.setMessage(o),!1)}),this.elements.cant.on("click",function(){return f.cifraclub.ccidbar.isReady()?(f.cifraclub.ccidbar.doLogged(function(){s.save("cant")},{selector:s.elements.cant,position:"top left"}),!1):(f.util.setMessage(o),!1)})},d.prototype.save=function(e){var s,o=this,n=e===this.status;s=n?"user/"+f.cifraclub.ccidbar.getUser().id+"/remove-can-play.json":"user/"+f.cifraclub.ccidbar.getUser().id+"/can"+("cant"==e?"not":"")+"-play.json",t.ajax({url:f.api.getUrl(1)+s,type:"POST",dataType:"json",data:{sid:o.cifra.id_cifra,tid:o.cifra.tipo}}).then(function(){o.update(n?null:e)})},d.prototype.update=function(e){var t;return this.status?(this.elements[this.status].addClass("off"),t=parseInt(this.elements[this.status].find("span").html(),10),this.elements[this.status].find("span").html(t-1),"can"==this.status&&this.elements.users.find("li").eq(0).remove()):("cant"==e||"can"==e)&&this.elements["can"==e?"cant":"can"].addClass("off"),null===e?(this.status=null,void this.elements.can.add(this.elements.cant).removeClass("off")):(this.elements[e].removeClass("off"),t=parseInt(this.elements[e].find("span").html(),10),this.elements[e].find("span").html(t+1),this.status=e,void("can"==this.status&&(8==this.elements.users.find("li").length&&this.elements.users.find("li").eq(6).remove(),this.elements.users.find("ul").prepend('<li><a href="/musico_eu.html" title="'+f.cifraclub.ccidbar.getUser().nickname+'" class="thumb"><img height="30" width="30" alt="'+f.cifraclub.ccidbar.getUser().nickname+'" src="'+f.cifraclub.ccidbar.getUser().avatar()+'"></a></li>'),this.elements.users.show())))},c.prototype.showModal=function(){this.modal.css("top",this.icon.offset().top-75).css("left",this.icon.offset().left-10).addClass("on")},c.prototype.hideModal=function(){this.modal.removeClass("on")},c.prototype.bindEvents=function(){var e=this,t=500;this.icon.on("mouseenter",function(){clearInterval(e.interval),e.showModal()}).on("mouseleave",function(){e.interval=setTimeout(function(){e.hideModal()},t)}).on("click",function(e){e.stopPropagation()}),this.modal.on("mouseenter",function(){clearInterval(e.interval),e.showModal()}).on("mouseleave",function(){e.interval=setTimeout(function(){e.hideModal()},t)})},c.prototype.init=function(){return this.bindEvents(),this},u.prototype.settings={modal:t("#c-dic"),trigger:t("#js-open_dictionary"),openedTime:null,scriptLoaded:!1},u.prototype.bindEvents=function(){var e=this;this.settings.modal.on("open",function(){var t;return e.settings.openedTime=parseInt((new Date).getTime()/1e3),e.settings.scriptLoaded?void f.cifraclub.dicionario.reset(e.settings.modal):(e.settings.modal.find(".c-mod_cnt").addClass("bg_loading"),t=document.createElement("link"),t.media="all",t.type="text/css",t.rel="stylesheet",t.href=f.files.css.dicionario,document.getElementsByTagName("head")[0].appendChild(t),void $LAB.script(f.files.js.dicionario).wait(function(){f.cifraclub.dicionario("widget","cifra"),e.settings.scriptLoaded=!0,f.cifraclub.dicionario.reset(e.settings.modal),e.settings.modal.find(".c-mod_cnt").removeClass("bg_loading")}))}).on("close",function(){salva_evento("dicionario_acordes","fechou","cifra",parseInt((new Date).getTime()/1e3)-e.settings.openedTime),e.settings.openedTime=null,f.song.modalHandler.removeFreeze(t("body"))}).on("click",".c-mod_close",function(){f.song.modalHandler.close(e.settings.modal,e.settings.trigger)}),this.settings.trigger.on("click",function(e){return e.preventDefault(),f.song.modalHandler.addFreeze(t("body")),!1}),f.song.modalHandler.bindToggle(this.settings.modal,this.settings.trigger,!1)},u.prototype.init=function(e){t.extend(this.settings,e),this.bindEvents()},h.prototype.playerName="Player",h.prototype.setYTVideo=function(e){this.ytVideo=e,this.videoInfo={name:"",length:0,views:0,url:"",repeatTimes:0},this.videoInfoLoaded=!1},h.prototype.createPlayer=function(){var e=this;this.player=new YT.Player(e.getContainerSelector(),{width:e.getOptions("width"),height:e.getOptions("height"),videoId:e.getYTVideo(),playerVars:e.getOptions("playerVars"),events:{onReady:e.videoReady(),onStateChange:e.onPlayerStateChange.bind(this)||t.noop}})},h.prototype.videoReady=function(){var e=this;setTimeout(function(){e.getVideoInfo(),e.setVolume(e.getSavedVolume(),!0),e.videoPlayingWatcher()},1e3)},h.prototype.getYTVideo=function(){return this.ytVideo},h.prototype.changeYTVideo=function(e){this.player&&"function"==typeof this.player.loadVideoById&&this.player.loadVideoById(e),this.seekTo(this.getSavedElapsedTime(e)),this.lastYTVideo=this.ytVideo,this.setYTVideo(e)},h.prototype.setVideoInfo=function(e){this.videoInfo=t.extend({},this.videoInfo,e)},h.prototype.getVideoInfo=function(){if(this.player&&"function"==typeof this.player.getDuration&&this.ytVideo){var e={length:this.player.getDuration(),url:this.player.getVideoUrl()};this.setVideoInfo(e),this.videoInfoLoaded=!0,this.videoInfo.repeatTimes=0}return this.videoInfo},h.prototype.setContainerSelector=function(e){this.containerSelector=e},h.prototype.getContainerSelector=function(){return this.containerSelector},h.prototype.getContainerElement=function(){return t("#"+this.getContainerSelector())},h.prototype.setOptions=function(e){this.options=t.extend(!0,{},this.options,e)},h.prototype.getOptions=function(e){return e===s?this.options:this.options[e]===s?s:this.options[e]},h.prototype.play=function(){this.player&&"function"==typeof this.player.playVideo&&(this.player.playVideo(),this.startTiming())},h.prototype.salvaEventoPlay=function(){this.alreadyPlayed||(salva_evento(this.playerName,"Play",f.song.info.artistSlug+" - "+f.song.info.songSlug),this.alreadyPlayed=!0)},h.prototype.pause=function(e){this.player&&"function"==typeof this.player.pauseVideo&&this.player.pauseVideo()},h.prototype.salvaEventoPause=function(){salva_evento(this.playerName,"Pause",f.song.info.artistSlug+" - "+f.song.info.songSlug)},h.prototype.playPause=function(){1===this.getPlayStatus()?this.pause():(0===this.getPlayStatus()||2===this.getPlayStatus())&&this.play()},h.prototype.stop=function(){this.player&&"function"==typeof this.player.stopVideo&&(this.player.stopVideo(),salva_evento(this.playerName,"Stop",f.song.info.artistSlug+" - "+f.song.info.songSlug))},h.prototype.setRepeatVideo=function(e){this.repeatVideo=e},h.prototype.isToRepeat=function(){return this.repeatVideo},h.prototype.isMuted=function(){return this.player&&"function"==typeof this.player.isMuted?this.player.isMuted():!1},h.prototype.mute=function(){this.player&&"function"==typeof this.player.isMuted&&(this.isMuted()?(this.player.unMute(),this.setSavedVolume(this.getSavedVolume()),salva_evento(this.playerName,"Unmute",f.song.info.artistSlug+" - "+f.song.info.songSlug)):(this.player.mute(),this.setSavedVolume(0),salva_evento(this.playerName,"Mute",f.song.info.artistSlug+" - "+f.song.info.songSlug)))},h.prototype.seekTo=function(e,t){var t=t||!1;if(this.player&&"function"==typeof this.player.seekTo){var s=this.getVideoLength();if(t){var o=this.getRelativeTime(e);this.seekTo(o)}else e>=0&&s>e&&this.player.seekTo(e,!0)}},h.prototype.getRelativeTime=function(e){var t=this.getCurrentTime(),e=parseInt(e),s=t+e,o=this.getVideoLength();return 0>s?s=0:s>o&&(s=o),s},h.prototype.setVolume=function(e,t){0>e?e=0:e>100&&(e=100),this.setSavedVolume(e),this.player&&"function"==typeof this.player.setVolume&&this.player.setVolume(e)},h.prototype.getVolume=function(){return this.player&&"function"==typeof this.player.getVolume?this.player.getVolume():0},h.prototype.getCurrentTime=function(e){if(this.player&&"function"==typeof this.player.getCurrentTime){var e=e||!1,t=this.player.getCurrentTime();return e===!0&&(t=this.parseTime(t)),t}return 0},h.prototype.getVideoLength=function(e){var e=e||!1,t=this.getVideoInfo().length;return e===!0&&(t=this.parseTime(t)),t},h.prototype.parseNewLength=function(e){if(isNaN(e)&&e.indexOf("PT")>-1){var t=e.match(/PT((\d*)H+)?((\d*)M+)?((\d*)S+)?/);e=0;for(var s=0;s<t.length;s++)if(s%2==0){var o=t[t.length-1-s]*(s>0?Math.pow(60,s/2):1);e+=isNaN(o)?0:o}}return e},h.prototype.parseTime=function(e){e=this.parseNewLength(e);var t=parseInt(e/60),s=parseInt(e%60);return(10>t?"0":"")+t+":"+(10>s?"0":"")+s},h.prototype.getPlayStatus=function(){if(this.player&&"function"==typeof this.player.getPlayerState){var e=this.player.getPlayerState();return 5==e?-1:e}},h.prototype.setPlaybackQuality=function(e){this.player&&"function"==typeof this.player.setPlaybackQuality&&this.player.setPlaybackQuality(e)},h.prototype.getPercentageBuffered=function(){return this.player&&"function"==typeof this.player.getVideoLoadedFraction?100*this.player.getVideoLoadedFraction():void 0},h.prototype.setSavedVolume=function(e){var t=new Date;t.setTime(t.getTime()+2592e6),document.cookie=this.keys.volume+"="+encodeURIComponent(e)+"; expires="+t.toUTCString()+"; path=/"},h.prototype.getSavedVolume=function(){return gC(this.keys.volume)||100},h.prototype.getSavedElapsedTime=function(e){var t=JSON.parse(gC(this.keys.times))||{},s=new Date;for(var o in t){var n=new Date(t[o].date);s-n>864e5&&delete t[o]}return t[e]?t[e].time:0},h.prototype.setSavedElapsedTime=function(e,t,s){var o=new Date;o.setTime(o.getTime()+864e5);var n=JSON.parse(gC(this.keys.times))||{};n[e]={time:t,date:new Date},25>s-t&&(n[e].time=0),document.cookie=this.keys.times+"="+encodeURIComponent(JSON.stringify(n))+"; expires="+o.toUTCString()+"; path=/"},h.prototype.getPlayers=function(){return h.players},h.prototype.pauseOthers=function(e){var s,o;for(var n in h.players)h.players[n]!=e&&("Videoaula"===h.players[n].constructor.name&&(s=h.players[n],o=s.getPlayStatus()),h.players[n].pause(!1));"undefined"!=typeof s&&1!==o&&(t("body").removeClass("fix-player"),"undefined"!=typeof s.elements&&s.elements.player.addClass("other-playing"));try{localStorage.setItem("masterPlaying",e.uniqueId)}catch(i){}},h.prototype.setSize=function(e){var e=t.extend({},{width:640,height:390},e);this.player.setSize(e.width,e.height)},h.prototype.stopTrakingProgress=function(){clearInterval(this.timingTracker),this.timingTracker=null},h.prototype.startTrakingProgress=function(){var e=this;!this.timingTracker&&this.ytVideo&&(this.timingTracker=setInterval(function(){var s=e.getCurrentTime(),o=e.getVideoLength(),n=0,i=0,a=0,l={};if(e.playedSeconds[parseInt(s,10)]=!0,i=e.playedSeconds.filter(function(e){return e===!0}).length,n=parseInt(100*i/o,10),a=[10,50,90].indexOf(n)>-1?n:0,0!==a&&a>e.lastSentProgress){if(e.ytVideo){l={id_video:e.ytVideo,progresso:a};try{l.id_cifra=f.song.info.cifraId,l.id_musica=f.song.info.songId,l.tipo_cifra=f.song.info.instrumentId,l.tipo_player=e.playerName}catch(r){l.id_cifra="",l.id_musica="",l.tipo_cifra="",l.tipo_player=""}t.ajax({url:f.api.getHitsUrl()+"video/register-progress",type:"post",data:l})}e.lastSentProgress=a}},400))},h.prototype.stopTiming=function(){clearInterval(this.timing),this.timing=null},h.prototype.startTiming=function(){var e=this;!this.timing&&this.ytVideo&&(this.timing=setInterval(function(){e.loopFunction()},100))},h.prototype.videoPlayingWatcher=function(){var e=this;setInterval(function(){var t=e.getPlayStatus();return e.isToRepeat()&&e.getCurrentTime()+1>=e.getVideoLength()?(e.seekTo(0),clearTimeout(e.timeoutEvento),void(e.timeoutEvento=setTimeout(function(){salva_evento(e.playerName,"Repetiu vídeo",f.song.info.artistSlug+" - "+f.song.info.songSlug,++e.videoInfo.repeatTimes)},800))):(e.setSavedElapsedTime(e.ytVideo,parseInt(e.getCurrentTime()),e.getVideoLength()),t!=e.lastStatus&&(e.onStateChange(t),(1==t||3==t)&&(-1==e.lastStatus&&(e.onVideoStart(),e.startTiming(),e.startTrakingProgress()),e.shouldPauseOthers&&1!=e.lastStatus&&3!=e.lastStatus&&e.pauseOthers(e)),0==t&&(e.stopTiming(),e.stopTrakingProgress(),e.onVideoStop()),""!=e.lastYTVideo&&e.lastYTVideo!=e.ytVideo&&(e.onVideoChange(e.lastYTVideo,e.ytVideo),e.lastYTVideo=e.ytVideo)),void(e.lastStatus=t))},1)},h.prototype.otherPlaying=function(e){for(var t in h.players)if(h.players[t]!=e){var s=h.players[t].getPlayStatus();if(1===s||3===s)return!0}return!1},h.prototype.loopFunction=function(){},h.prototype.onStateChange=function(){},h.prototype.onVideoStart=function(){},h.prototype.onVideoStop=function(){salva_evento(this.playerName,"video_completo",f.song.info.artistSlug+" - "+f.song.info.songSlug)},h.prototype.onVideoChange=function(e,t){salva_evento(this.playerName,"Mudou de vídeo",f.song.info.artistSlug+" - "+f.song.info.songSlug)},h.prototype.onPlayerStateChange=function(e){switch(e.data){case 1:this.salvaEventoPlay();break;case 2:this.salvaEventoPause()}},p.prototype=new h,p.prototype.constructor=p,p.prototype.playerName="Videoaula",p.prototype.resetData=function(){this.elements.progressLoad.add(this.elements.progressPlay).width(0)},p.prototype.startVideoLesson=function(){this.elements.labelVideoLength.html(this.getVideoLength(!0)),this.play()},p.prototype.bindEvents=function(){var e=this,s="fullscreenchange mozfullscreenchange webkitfullscreenchange";t(this.elements.progressSeek).slider({animate:0,value:0,max:100,min:0,step:.01,slide:function(t,s){var o=e.getVideoLength(),n=s.value*o/100;e.seekTo(n),e.setProgress(e.elements.progressPlay,s.value)},start:function(){e.dragControl=!0},stop:function(){if(e.repeatChapter>-1){var s=t(e.elements.modalChapters).find("li a"),o=s.eq(e.repeatChapter).data("startTime"),n=s.eq(e.repeatChapter+1).data("startTime")||e.getVideoLength(),i=e.getCurrentTime();(o>i||i>n)&&e.setRepeatChapter(-1)}e.dragControl=!1}}),t(this.elements.buttonPlayPause).click(function(){e.playPause(),null==this.jsPlayer&&e.startTiming(),1===e.getPlayStatus()?e.changeButtonPlayPauseIcon("aula-play"):e.changeButtonPlayPauseIcon("aula-pause")}),t(this.elements.buttonSeekLess15).click(function(){e.seekTo(-15,!0),salva_evento("Player_Videoaula","Retrocedeu 15s",f.song.info.artistSlug+" - "+f.song.info.songSlug,parseInt(e.getCurrentTime()))}),t(this.elements.buttonSeekMore15).click(function(){e.seekTo(15,!0),salva_evento("Player_Videoaula","Avançou 15s",f.song.info.artistSlug+" - "+f.song.info.songSlug,parseInt(e.getCurrentTime()))}),t(this.elements.buttonMute).click(function(){e.isMuted()?(t(e.elements.buttonMute).find("i").removeClass("mute"),e.setVolume(e.getVolume(),!0)):(t(e.elements.buttonMute).find("i").addClass("mute"),e.setVolume(0,!0)),e.mute()}),t(this.elements.volumeSlider).slider({value:100,max:100,min:0,step:1,start:function(){t(e.elements.volumeSlider).parent().parent().addClass("on")},slide:function(t,s){e.setVolume(s.value)},stop:function(){t(e.elements.volumeSlider).parent().parent().removeClass("on")}}),t(this.elements.buttonConfig).click(function(){e.modalControl(this,e.elements.modalConfig)}),t(this.elements.modalConfig).find("li").click(function(){e.elements.modalConfig.find("li").removeClass("on"),t(this).addClass("on"),e.setPlaybackQuality(t(this).find("a").data("quality")),e.modalControl(e.elements.buttonConfig,e.elements.modalConfig)}),t(this.elements.buttonFullScreen).click(function(){e.enterFullScreen()}),t(document).on(s,function(){var t=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;t||e.leaveFullScreen()}),t(this.elements.labelChapter).click(function(){e.modalControl(this,e.elements.modalChapters)}),t(this.elements.modalChapters).on("click","li a",function(){e.setRepeatChapter(-1),e.seekTo(t(this).data("startTime"),!1),salva_evento("Player_Videoaula","Mudou capítulo",f.song.info.artistSlug+" - "+f.song.info.songSlug,e.currentChapter)}),t(this.elements.modalChapters).on("click",".js-chapter-repeat",function(){var s=t(e.elements.modalChapters).find("li");t(this).toggleClass("on"),e.setRepeatChapter(t(this).hasClass("on")?s.index(s.filter(".on")):-1)}),t(this.elements.modalChapters).find(".scroll").perfectScrollbar()},p.prototype.isJsPlayer=function(){return null===this.jsPlayer||this.jsPlayer==s?!1:!0},p.prototype.isBoltPlayer=function(){return null===this.boltPlayer||this.boltPlayer==s?!1:!0},p.prototype.play=function(){this.elements.player.removeClass("freeze"),this.isBoltPlayer()?this.boltPlayer.playMedia("boltPlayer"):this.isJsPlayer()?(this.jsPlayer.play(),this.startTiming(),this.alreadyPlayed||(salva_evento(this.playerName,"Play",f.song.info.artistSlug+" - "+f.song.info.songSlug),this.alreadyPlayed=!0)):h.prototype.play.call(this)},p.prototype.pause=function(e){this.isBoltPlayer()?this.boltPlayer.pauseMedia("boltPlayer"):this.isJsPlayer()?(this.jsPlayer.pause(),0!=e&&salva_evento(this.playerName,"Pause",f.song.info.artistSlug+" - "+f.song.info.songSlug)):h.prototype.pause.call(this,e)},p.prototype.freeze=function(){this.pause(),this.elements.player.addClass("freeze")},p.prototype.getPlayStatus=function(){return this.isJsPlayer()?this.jsPlayer.ended()?0:this.jsPlayer.paused()?2:1:h.prototype.getPlayStatus.call(this);
},p.prototype.getCurrentTime=function(e){if(this.isJsPlayer()){var t=this.jsPlayer.currentTime();return e&&(t=this.parseTime(t)),t}return h.prototype.getCurrentTime.call(this,e)},p.prototype.getVideoLength=function(e){if(this.isJsPlayer()){var t=this.jsPlayer.duration();return e===!0&&(t=this.parseTime(t)),t}return h.prototype.getVideoLength.call(this,e)},p.prototype.getPercentageBuffered=function(){return this.isJsPlayer()?100*this.jsPlayer.bufferedPercent():h.prototype.getPercentageBuffered.call(this)},p.prototype.seekTo=function(e,t){this.isBoltPlayer()?this.boltPlayer.seek("boltPlayer",e):this.isJsPlayer()?(t&&(e=this.getRelativeTime(e)),this.jsPlayer.currentTime(e)):h.prototype.seekTo.call(this,e,t)},p.prototype.isMuted=function(){return this.isJsPlayer()?this.jsPlayer.muted():h.prototype.isMuted.call(this)},p.prototype.mute=function(){this.isJsPlayer()?this.isMuted()?this.jsPlayer.muted(!1):this.jsPlayer.muted(!0):h.prototype.mute.call(this)},p.prototype.getVolume=function(){return this.isJsPlayer()?100*this.jsPlayer.volume():h.prototype.getVolume.call(this)},p.prototype.loopFunction=function(){var e=this,s=-1;if(1===this.getPlayStatus()||3===this.getPlayStatus()?this.changeButtonPlayPauseIcon("aula-pause"):this.changeButtonPlayPauseIcon("aula-play"),this.elements){var o=100*this.getCurrentTime()/this.getVideoLength();if(this.setProgress(this.elements.progressLoad,this.getPercentageBuffered()),this.dragControl===!1){this.setProgress(this.elements.progressPlay,o),t(this.elements.progressSeek).slider("value",o);var n=t(this.elements.modalChapters).find("li a").eq(this.repeatChapter+1).data("startTime")||this.getVideoLength(),i=this.getCurrentTime();this.repeatChapter>-1&&i>=n&&this.seekTo(t(this.elements.modalChapters).find("li a").eq(this.repeatChapter).data("startTime"))}t(this.elements.labelVideoElapsed).html(this.getCurrentTime(!0)),t(this.elements.modalChapters).find("li a").each(function(o){e.getCurrentTime()>=t(this).data("startTime")&&(s=o)})}this.selectChapter(s)},p.prototype.setProgress=function(e,s){0>s?s=0:s>100&&(s=100),t(e).width(s+"%")},p.prototype.changeButtonPlayPauseIcon=function(e){this.elements&&t(this.elements.buttonPlayPause).removeClass("aula-pause aula-play").addClass(e)},p.prototype.enterFullScreen=function(){var e=document.documentElement;if(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){var s=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;s?this.leaveFullScreen():(e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen(),this.isJsPlayer()&&this.jsPlayer.height(screen.height-32).width(screen.width),t("body").addClass("aula-fullscreen"),t(this.elements.buttonFullScreen).addClass("aula-full-exit"),salva_evento("Player_Videoaula","Entrou fullscreen",f.song.info.artistSlug+" - "+f.song.info.songSlug))}else alert("O seu navegador não suporta fullscreen. =(")},p.prototype.leaveFullScreen=function(){(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled)&&(document.exitFullscreen?document.exitFullscreen():document.webkitExitFullscreen?document.webkitExitFullscreen():document.mozCancelFullScreen?document.mozCancelFullScreen():document.msExitFullscreen&&document.msExitFullscreen(),this.isJsPlayer()&&this.jsPlayer.height(360).width(640),t("body").removeClass("aula-fullscreen"),t(this.elements.buttonFullScreen).removeClass("aula-full-exit"),salva_evento("Player_Videoaula","Saiu fullscreen",f.song.info.artistSlug+" - "+f.song.info.songSlug))},p.prototype.setVolume=function(e,s){var s=s||!1;0>e?e=0:e>100&&(e=100),s!==!0&&(this.isJsPlayer()?this.jsPlayer.volume(e/100):h.prototype.setVolume.call(this,e)),"undefined"!=typeof this.elements&&(t(this.elements.volumeBar).width(e+"%"),t(this.elements.volumeSlider).slider("value",e),0===e?t(this.elements.buttonMute).find("i").addClass("mute"):50>e?t(this.elements.buttonMute).find("i").removeClass("mute").addClass("less"):t(this.elements.buttonMute).find("i").removeClass("mute less"))},p.prototype.modalControl=function(e,s){s.hasClass("on")?t(s).add(e).removeClass("on"):t(s).add(e).addClass("on")},p.prototype.selectChapter=function(e){e!=this.currentChapter&&this.elements&&(this.currentChapter=e,t(this.elements.modalChapters).find("li").removeClass("on"),t(this.elements.modalChapters).find("li").eq(e).addClass("on"),t(this.elements.labelChapter).html(e+1+". "+t(this.elements.modalChapters).find("li").eq(e).find("a").html()+"<i></i>"))},p.prototype.setRepeatChapter=function(e){e>-1?this.repeatChapter=e:(this.repeatChapter=-1,t(this.elements.modalChapters).find(".js-chapter-repeat").removeClass("on"))},p.prototype.onStateChange=function(e){2==e&&this.otherPlaying(this)===!0?(t("body").removeClass("fix-player"),"undefined"!=typeof this.elements&&this.elements.player.addClass("other-playing")):"undefined"!=typeof this.elements&&this.elements.player.removeClass("other-playing")},p.prototype.startJsPlayer=function(){var e=this;this.elements.buttonConfig.hide();var t='<video class="video-js vjs-default-skin" id="videoaula_videotag" width="640" height="360" preload></video>';this.elements.playerStage.html(t),this.jsPlayer=videojs("videoaula_videotag",{techOrder:["flash"],sources:[{type:"video/flv",src:"https://acubens.sscdn.co/palcomp3/cctv/"+e.ytVideo}]},function(){e.play()}).on("durationchange",function(){e.elements.labelVideoLength.html(e.parseTime(this.duration()))}).on("play",function(){e.pauseOthers(e)}),h.players.push(this)},p.prototype.startBoltPlayer=function(){var s,o,n,i=this;this.elements.buttonConfig.hide(),t(".aula-controls").hide(),this.elements.playerStage.addClass("bolt");var s=this.elements.playerStage[0],o=1014726,n="boltPlayer",a=document.createElement("script");a.src="//cdn.playwire.com/bolt/js/zeus/embed.js",a.type="text/javascript",a.id="script",a.setAttribute("data-config","//config.playwire.com/"+o+"/videos/v2/"+i.ytVideo+"/zeus.json"),a.setAttribute("data-css","http://cdn.playwire.com/bolt/js/zeus/skins/default.css"),a.setAttribute("data-width","100%"),a.setAttribute("data-height","100%"),a.setAttribute("data-id",n),a.setAttribute("data-autoload","false"),s.appendChild(a);var l=setInterval(function(){e.Bolt&&e.Bolt.embeds.boltPlayer&&(clearInterval(l),r("boltPlayer"))},50),r=function(e){Bolt.renderPlayer(e,function(){Bolt.playMedia("boltPlayer")}),i.boltPlayer=Bolt,Bolt.on("boltPlayer",Bolt.BOLT_CONTENT_STATE_CHANGED,function(e,t){"playing"==t.state&&i.pauseOthers(i)}),h.players.push(i)}},g.prototype=new h,g.prototype.constructor=g,g.prototype.playerName="Cover",g.prototype.setEvents=function(){var e=this;this.elements.coverList.container.on("click","li",function(){e.changeVideo(t(this))})},g.prototype.scrollToBox=function(){t("html, body").animate({scrollTop:t(".box.covers").offset().top},1e3)},g.prototype.changeVideo=function(e){var t={id:e.find("a").data("video"),name:e.find("span strong").html(),views:e.find("span small:eq(0)").html(),date:e.find("span small:eq(1)").html()},s={id:this.elements.coverPlaying.container.data("video"),name:this.elements.coverPlaying.container.find(".cover-name").html(),views:this.elements.coverPlaying.container.find(".cover-view").html(),date:this.elements.coverPlaying.container.find(".cover-date").html()};this.elements.coverPlaying.container.data("video",t.id),this.elements.coverPlaying.container.find(".cover-name").html(t.name),this.elements.coverPlaying.container.find(".cover-view").html(t.views),this.elements.coverPlaying.container.find(".cover-date").html(t.date),e.remove(),this.elements.coverList.container.prepend(this.getTemplate(s)),this.changeYTVideo(t.id)},g.prototype.searchCover=function(e){var s=!1;return this.elements.coverList.container.find("li a").each(function(){t(this).data("video")==e&&(t(this).parent().click(),s=!0)}),s},g.prototype.startCovers=function(){var e=this.elements.coverList.container.find("li").length,t=this.elements.commentsBox.height();if(0===e)this.elements.coverList.container.hide();else if(3>=e)this.elements.coverList.container.css("height","auto");else{var s=t-this.elements.coverList.container.position().top-514;s>60*e?this.elements.coverList.container.css("height","auto"):(this.elements.coverList.container.css("height",s),this.elements.coverList.container.perfectScrollbar(),this.elements.coverList.container.perfectScrollbar("update"))}},g.prototype.getTemplate=function(e){return'<li><a href="javascript:void(0);" data-video="'+e.id+'"><span class="aling-top"><span class="thumb"><img src="https://img.youtube.com/vi/'+e.id+'/default.jpg" width="90" /></span></span><span><strong class="top-txt_primary">'+e.name+"</strong><small>"+e.views+"</small><br /></span></a></li>"},m.prototype.searchVideos=function(e,s){var o=this,n=t.Deferred();if(0==this.searching&&(0==this.videos.length||this.videos.length>=this.searchData.max&&""!=this.searchData.nextPageToken)){this.searching=!0,t(this.elements.inputSearch).attr("disabled","disabled");var i={maxResults:this.searchData.max,order:"relevance",safeSearch:"moderate",part:"snippet",fields:"nextPageToken,items(id(videoId),snippet(title,thumbnails(default,high)))",type:"video",videoEmbeddable:"true",q:this.musicName,key:f.youtubeApiKey};""!=this.searchData.nextPageToken&&(i.pageToken=this.searchData.nextPageToken),t.getJSON(f.youtubeApiUrl+"search?"+t.param(i)).done(function(e){n.resolve(e)}),n.done(function(n){if(s&&o.videos.push({id:s,name:o.musicName}),t(o.elements.inputSearch).removeAttr("disabled"),n.items.length<=o.searchData.max)for(var i=0;i<n.items.length;i++){var a=n.items[i].id.videoId;o.videos.push({id:a,name:n.items[i].snippet.title})}n.nextPageToken?o.searchData.nextPageToken=n.nextPageToken:o.searchData.nextPageToken="",e(),o.searching=!1})}},m.prototype.searchVideosDetails=function(){for(var e=this,o="",n=[],i=t.Deferred(),a=0;a<this.videos.length;a++)if(this.videos[a].views==s){var l=this.videos[a].id;o+=l+",",n[l]=a}var r={part:"snippet,statistics,contentDetails",fields:"items(id,statistics(viewCount,likeCount),contentDetails(dimension,duration,caption))",id:o,key:f.youtubeApiKey};t.getJSON(f.youtubeApiUrl+"videos?"+t.param(r)).done(function(e){i.resolve(e)}),i.done(function(s){if(s.items.length>0)for(var o=0;o<s.items.length;o++){var i=s.items[o].id,a=n[i],l=e.parseVideoLength(s.items[o].contentDetails.duration);e.videos[a]=t.extend({},e.videos[a],{views:s.items[o].statistics.viewCount,length:l,time:e.parseVideoTime(l)})}t(e.elements.listVideos).find("ul").html(e.getVideoListTemplate()),t(e.elements.listVideos).perfectScrollbar("update"),e.videosDetails=!0})},m.prototype.parseVideoLength=function(e){var t=e.match(/PT((\d*)H+)?((\d*)M+)?((\d*)S+)?/);e=0;for(var s=0;s<t.length;s++)if(s%2==0){var o=t[t.length-1-s]*(s>0?Math.pow(60,s/2):1);e+=isNaN(o)?0:o}return e},m.prototype.parseVideoTime=function(e){var t=parseInt(e/60),s=parseInt(e%60);return(10>t?"0":"")+t+":"+(10>s?"0":"")+s},m.prototype.playVideoById=function(e){var s,o=this,n=-1;for(this.basePlayer||this.startPlayer(),s=0;s<this.videos.length;s++)if(this.videos[s].id===e){n=s;break}o.basePlayer.changeYTVideo(e),t(o.elements.divListVideos).removeClass("on"),t(o.elements.player).removeClass("pl--tools")},m.prototype.init=function(){this.setSize(this.lastSize,null,null,!0),t(this.elements.player).html(this.getPlayerTemplate()),this.searchElements(),0==this.videos.length?(t(this.elements.player).removeClass("pl--playing pl--on").addClass("pl--end pl--ad"),t(this.elements.buttonReplay).hide()):(t(this.elements.labelVideoNotFound).hide(),t(this.elements.inputSearch).val(this.videos[0].name)),this.bindEvents()},m.prototype.getPlayerMinSize=function(){return t(this.elements.cifraContent).hasClass("cols")?"pl--min":"pl--normal"},m.prototype.setSize=function(e,s,o,n){if(s){var i=-1;"plz_more"==s.className&&(i=1),e=this.actualSize+i}else this.isFullScreen()&&"undefined"!=typeof o&&(e=o);if(e>=0&&4>=e){var a=this.sizeOrder[e];t(this.elements.buttonSizes).removeClass("on"),this.elements.buttonSize&&t(this.elements.buttonSize[a]).addClass("on"),t(this.elements.player).removeClass("pl--closed pl--min pl--normal pl--max pl--full").addClass("pl--"+a),null!=this.basePlayer&&this.basePlayer.setSize(this.playerSizes[a]),t(this.elements.player).trigger("resize",e),0==e&&(this.pause(),t(this.elements.player).addClass("pl--min")),3===e?t(this.elements.cifraContent).addClass("p_max"):t(this.elements.cifraContent).removeClass("p_max"),4===e?e!=this.actualSize&&(this.enterFullScreen(),this.lastSize=this.actualSize):this.leaveFullScreen(),this.actualSize=e,n||salva_evento("Player_Video","redimensionou",f.song.info.artistSlug+" - "+f.song.info.songSlug,e)}},m.prototype.searchElements=function(){this.elements=t.extend(!0,this.elements,{buttonPlayStart:t("span.plm_play"),buttonPrevious:t("button.plc_prev"),buttonPlay:t("button.plc_play"),buttonPause:t("button.plc_pause"),buttonNext:t("button.plc_next"),buttonRepeat:t("button.plc_repeat"),buttonRepeatOnConfig:t("div.plt_repeat button"),buttonVolume:t("button.plv_bt"),buttonShuffle:t("button.plc_shuffle"),buttonConfig:t("button.plc_config"),buttonQuality:t("button.plt_quality_bt"),buttonSizeLess:t("button.plz_less"),buttonSizeMore:t("button.plz_more"),buttonFullScreen:t("button.plz_full"),buttonVideoList:t("button.plt_video_more"),buttonSize:{min:t("button.plt_size_min"),normal:t("button.plt_size_normal"),max:t("button.plt_size_max"),full:t("button.plt_size_full")},buttonSizes:t("button.plt_bt:not(.plt_rep_bt)"),buttonVideos:t("div.plt_video_cnt a"),buttonVideoListExit:t("button.pl_videos_ext"),buttonReplay:t("button.pl_end_repeat"),buttonSearch:t("button.pl_videos_sub"),divListVideos:t("div.pl_videos"),divProximoVideo:t("div.pl_end_thumb"),imageThumb:t("img.plm_thumb"),inputSearch:t("input.pl_videos_inp"),labelVideoElapsed:t("b.plc_current"),labelVideoLength:t("b.plc_duration"),labelVideoNotFound:t("strong.pl_end_notfound"),listQuality:t("ul.plt_quality_list"),listVideos:t("div.pl_videos_list"),progressSeek:t("div.plp_seek"),progressLoad:t("div.plp_load"),progressPlay:t("div.plp_play"),toolTip:t("div.pl_tooltip"),volumeSlider:t("div.plv_track"),volumeBar:t("div.plv_level"),volumeSliderVertical:t("div.plv_track_v"),volumeBarVertical:t("div.plv_level_v")})},m.prototype.bindEvents=function(){var e=this,s="fullscreenchange mozfullscreenchange webkitfullscreenchange";t(this.elements.buttonPlayStart).click(function(){e.startPlayer()}),t(this.elements.buttonSizeLess).add(this.elements.buttonSizeMore).click(function(){e.setSize(null,this)}),t(this.elements.buttonFullScreen).click(function(){e.setSize(4,null,e.lastSize),null===e.basePlayer&&e.startPlayer()}),t(document).on(s,function(){e.isFullScreen()||4!=e.getSize()||e.setSize(e.lastSize)}),t(this.elements.buttonPlay).click(function(){0==e.getSize()&&e.setSize(1),e.play()}),t(this.elements.buttonPause).click(function(){e.pause()}),t([this.elements.buttonRepeat[0],this.elements.buttonRepeatOnConfig[0]]).click(function(){t([e.elements.buttonRepeat[0],e.elements.buttonRepeatOnConfig[0]]).toggleClass("on off"),t(this).hasClass("on")?(e.basePlayer.setRepeatVideo(!0),salva_evento("Player_Video","Repetir on",f.song.info.artistSlug+" - "+f.song.info.songSlug)):(e.basePlayer.setRepeatVideo(!1),salva_evento("Player_Video","Repetir off",f.song.info.artistSlug+" - "+f.song.info.songSlug))}),t(this.elements.buttonVolume).parent().hover(function(){t(this).addClass("on")},function(){e.volumeSliding===!1&&t(this).removeClass("on")}),t(this.elements.buttonVolume).click(function(){t(this).toggleClass("plv--off"),e.basePlayer.mute(),e.basePlayer.isMuted()?e.setVolume(e.basePlayer.getVolume(),!0):e.setVolume(0,!0)}),t(this.elements.volumeSlider).slider({value:100,max:100,min:0,step:1,start:function(){t(e.elements.buttonVolume).parent().addClass("on"),e.volumeSliding=!0},slide:function(t,s){e.setVolume(s.value)},stop:function(){t(e.elements.buttonVolume).parent().removeClass("on"),e.volumeSliding=!1}}),t(this.elements.volumeSliderVertical).slider({value:100,max:100,min:0,step:1,orientation:"vertical",start:function(){t(e.elements.buttonVolume).parent().addClass("on"),e.volumeSliding=!0},slide:function(t,s){e.setVolume(s.value)},stop:function(){t(e.elements.buttonVolume).parent().removeClass("on"),e.volumeSliding=!1}}),t(this.elements.progressSeek).mousemove(function(s){if(e.basePlayer){var o=t(this).width(),n=s.pageX-t(e.elements.player).offset().left,i=100*n/o,a=i*e.basePlayer.getVideoLength()/100;t(e.elements.toolTip).css("left",n-19).html(e.basePlayer.parseTime(a))}}).slider({value:0,max:100,min:0,step:.01,slide:function(t,s){var o=e.basePlayer.getVideoLength(),n=s.value*o/100;e.basePlayer.seekTo(n),e.setProgress(e.elements.progressPlay,s.value)},start:function(){e.dragControl=!0},stop:function(){e.dragControl=!1}}),t(this.elements.buttonConfig).click(function(){t(e.elements.player).toggleClass("pl--tools"),0==e.videosDetails&&e.searchVideosDetails()}),t(this.elements.buttonVideos).click(function(){var s=t(this).data("id"),o=e.basePlayer.ytVideo;t(this).data("id",o),t(this).find("img").attr("src","//i.ytimg.com/vi/"+o+"/default.jpg"),e.basePlayer.changeYTVideo(s),t(e.elements.divListVideos).removeClass("on"),t(e.elements.player).toggleClass("pl--tools")}),t(this.elements.buttonQuality).click(function(){t(e.elements.listQuality).toggleClass("on")}),t(this.elements.listQuality).find("a").click(function(){e.basePlayer.setPlaybackQuality(t(this).data("level")),t(e.elements.buttonQuality).html(t(this).html()),t(e.elements.listQuality).toggleClass("on")}),t(this.elements.buttonSize.min).click(function(){e.setSize(1)}),t(this.elements.buttonSize.normal).click(function(){e.setSize(2)}),t(this.elements.buttonSize.max).click(function(){e.setSize(3)}),t(this.elements.buttonSize.full).click(function(){e.setSize(4)}),t(this.elements.buttonVideoList).click(function(){t(e.elements.divListVideos).addClass("on"),t(e.elements.listVideos).perfectScrollbar("update"),salva_evento("Player_Video","mais_videos_on",f.song.info.artistSlug+" - "+f.song.info.songSlug)}),t(this.elements.buttonVideoListExit).click(function(){t(e.elements.divListVideos).removeClass("on"),t(e.elements.player).toggleClass("pl--tools"),salva_evento("Player_Video","mais_videos_off",f.song.info.artistSlug+" - "+f.song.info.songSlug)}),t(this.elements.listVideos).on("click","a",function(){e.basePlayer.changeYTVideo(t(this).data("id")),t(e.elements.divListVideos).removeClass("on"),t(e.elements.player).toggleClass("pl--tools")}).scroll(function(){e.elements.listVideos[0].scrollHeight-e.elements.listVideos.scrollTop()==e.elements.listVideos.outerHeight()&&e.searchVideos(function(){e.searchVideosDetails()})}),t(this.elements.listVideos).perfectScrollbar(),t(this.elements.inputSearch).keydown(function(s){var o=t(this).val().trim();13==s.which&&o.length>0&&(e.videos=[],e.musicName=o,e.searchData.start=1,e.searchVideos(function(){t(e.elements.listVideos).find("ul").html(e.getVideoListTemplate()),t(e.elements.listVideos).perfectScrollbar("update"),salva_evento("Player_Video","Player_busca",f.song.info.artistSlug+" - "+f.song.info.songSlug)}),s.stopPropagation(),s.preventDefault())}),t(this.elements.buttonSearch).click(function(){var s=t(e.elements.inputSearch).val().trim();s.length>0&&(e.videos=[],e.musicName=s,e.searchData.start=1,e.searchVideos(function(){t(e.elements.listVideos).find("ul").html(e.getVideoListTemplate()),t(e.elements.listVideos).perfectScrollbar("update")}))}),t(this.elements.buttonReplay).click(function(){e.play(),t(e.elements.player).removeClass("pl--end pl--ad").addClass("pl--playing pl--on")}),t(this.elements.divProximoVideo).click(function(){e.basePlayer.changeYTVideo(t(this).data("id")),e.play(),t(e.elements.player).removeClass("pl--end pl--ad").addClass("pl--playing pl--on")})},m.prototype.startPlayer=function(){var e=this,s={playerVars:{showinfo:0}};t([this.elements.buttonPlayStart,this.elements.imageThumb]).remove(),t(this.elements.player).addClass("pl--on pl--playing"),s=t.extend({},s,this.playerSizes[this.sizeOrder[this.actualSize]]),h.prototype.loopFunction=function(){t(e.elements.labelVideoElapsed).html(this.getCurrentTime(!0));var s=100*this.getCurrentTime()/this.getVideoLength();e.setProgress(e.elements.progressLoad,this.getPercentageBuffered()),e.dragControl===!1&&(e.setProgress(e.elements.progressPlay,s),t(e.elements.progressSeek).slider("value",s));var o=this.getPlayStatus();1===o||3===o||5===o?t(e.elements.player).removeClass("pl--paused").addClass("pl--playing"):t(e.elements.player).removeClass("pl--playing").addClass("pl--paused")},h.prototype.onVideoStart=function(){e.setVolume(this.getSavedVolume(),!0),e.elements.labelVideoLength.html(this.getVideoLength(!0)),salva_evento("Player_Video","Play",f.song.info.artistSlug+" - "+f.song.info.songSlug),this.alreadyPlayed=!0},h.prototype.onVideoStop=function(){t(e.elements.player).addClass("pl--end"),salva_evento("Player_Video","video_completo",f.song.info.artistSlug+" - "+f.song.info.songSlug)},h.prototype.onVideoChange=function(t,s){var o=this,n=setInterval(function(){e.elements.labelVideoLength.html(o.getVideoLength(!0)),0!=o.getVideoLength()&&clearInterval(n)},500);salva_evento("Player_Video","Mudou de vídeo",f.song.info.artistSlug+" - "+f.song.info.songSlug)},this.basePlayer=new h(this.videos[0].id,this.elements.playerStage,s,null,"Videos"),this.basePlayer.playerName="Video"},m.prototype.isFullScreen=function(){if(document.fullscreenEnabled||document.webkitFullscreenEnabled||document.mozFullScreenEnabled||document.msFullscreenEnabled){var e=document.fullscreenElement||document.webkitFullscreenElement||document.mozFullScreenElement||document.msFullscreenElement;if(e)return!0}return!1},m.prototype.enterFullScreen=function(){var e=t(this.elements.player)[0];this.isFullScreen()?this.leaveFullScreen():e.requestFullscreen?e.requestFullscreen():e.webkitRequestFullscreen?e.webkitRequestFullscreen():e.mozRequestFullScreen?e.mozRequestFullScreen():e.msRequestFullscreen&&e.msRequestFullscreen()},m.prototype.leaveFullScreen=function(){var e=t(document)[0];this.isFullScreen()&&(e.exitFullscreen?e.exitFullscreen():e.webkitExitFullscreen?e.webkitExitFullscreen():e.mozCancelFullScreen?e.mozCancelFullScreen():e.msExitFullscreen&&e.msExitFullscreen())},m.prototype.getSize=function(){return this.actualSize},m.prototype.play=function(){this.elements.player.trigger("beforeplay"),this.basePlayer||this.startPlayer(),this.basePlayer.play(),t(this.elements.player).removeClass("pl--paused").addClass("pl--playing")},m.prototype.pause=function(){null!=this.basePlayer&&"function"==typeof this.basePlayer.pause&&(this.basePlayer.pause(),t(this.elements.player).removeClass("pl--playing").addClass("pl--paused"))},m.prototype.setVolume=function(e,s){var s=s||!1;0>e?e=0:e>100&&(e=100),s!==!0&&null!==this.basePlayer&&this.basePlayer.setVolume(e),"undefined"!=typeof this.elements&&(t(this.elements.volumeBar).width(e+"%"),t(this.elements.volumeBarVertical).height(e+"%"),t(this.elements.volumeSlider).slider("value",e),t(this.elements.volumeSliderVertical).slider("value",e),0===e?t(this.elements.buttonVolume).removeClass("plv--high plv--low").addClass("plv--off"):50>e?t(this.elements.buttonVolume).removeClass("plv--high plv--off").addClass("plv--low"):t(this.elements.buttonVolume).removeClass("plv--low plv--off").addClass("plv--high"))},m.prototype.setProgress=function(e,s){0>s?s=0:s>100&&(s=100),t(e).width(s+"%")},m.prototype.getPlayerTemplate=function(){var e=["","","",""];return e[this.actualSize]="on",'<div class="pl_skip" style="display:none;">Pular anuncio »</div><div class="pl_media"><img class="plm_thumb" src="//i.ytimg.com/vi/'+(this.videos.length>0?this.videos[0].id:"000")+'/0.jpg" alt="" width="350" height="200"><div class="plm_embed" id="player__pl_obj"><div id="videos-player"></div></div><span class="plm_play"><b></b>play</span></div><div class="pl_progress" aria-disabled="false"><div class="plp_load"></div><div class="plp_play"></div><div class="plp_seek"></div></div><div class="pl_tooltip js-tp-pbar">00:00</div><div class="pl_controls"><button class="plc_play" title="play"><b></b>play</button><button class="plc_pause" title="pause"><b></b>pausar</button><button class="plc_repeat off" title="repetir"><b></b>repetir</button><div class="pl_vol"><button class="plv_bt plv--high" title="volume"><b></b>volume</button><div class="plv_control"><div class="plv_bar"><div class="plv_level"></div></div><div class="plv_track"></div></div><div class="plv_control_v"><div class="plv_bar_v"><div class="plv_level_v"></div></div><div class="plv_track_v"></div></div></div><div class="plc_time"><b class="plc_current">00:00</b> / <b class="plc_duration">00:00</b></div><div class="plc_right"><button class="plc_shuffle" title="aleatório"><b></b>aleatório</button><button class="plc_config" title="opções"><b></b><span>opções</span></button></div></div><div class="pl_size"><button class="plz_less" title="diminuir"><b></b>diminuir</button><button class="plz_more" title="aumentar"><b></b>aumentar</button><button class="plz_full" title="tela cheia"><b></b>tela cheia</button></div><div class="pl_info_wrap"><div class="pl_info"><ul></ul></div></div><div class="pl_tools"><div class="plt_config"><div class="plt_video"><span>outros vídeos desta música</span><div class="plt_video_cnt">'+(this.videos.length>=2?'<a href="javascript:void(0);" data-id="'+this.videos[1].id+'"><img src="//i.ytimg.com/vi/'+this.videos[1].id+'/default.jpg" alt="'+this.videos[1].name+'"></a>':"")+(this.videos.length>=3?'<a href="javascript:void(0);" data-id="'+this.videos[2].id+'"><img src="//i.ytimg.com/vi/'+this.videos[2].id+'/default.jpg" alt="'+this.videos[2].name+'"></a>':"")+"</div>"+(this.videos.length>=4?'<button class="plt_video_more" title="outros vídeos desta música">ver +</button>':"")+'</div><div class="sep"></div><div class="plt_size"><span>tamanho</span><button class="plt_bt plt_size_min '+e[0]+'" title="pequeno"><b></b>pequeno</button><button class="plt_bt plt_size_normal '+e[1]+'" title="normal"><b></b>normal</button><button class="plt_bt plt_size_max '+e[2]+'" title="grande"><b></b>grande</button><button class="plt_bt plt_size_full '+e[3]+'" title="tela inteira"><b></b>tela inteira</button></div><div class="plt_repeat"><span>repetir</span><button class="plt_bt plt_rep_bt" title="repetir"><b>repetir</b></button></div><div class="sep"></div><div class="plt_quality"><span> qualidade </span><button class="plt_bt_t plt_quality_bt">automático</button><ul class="plt_quality_list"><li><a href="javascript:void(0);" data-level="hd1080">1080p</a></li><li><a href="javascript:void(0);" data-level="hd720">720p</a></li><li><a href="javascript:void(0);" data-level="large">480p</a></li><li><a href="javascript:void(0);" data-level="medium">360p</a></li><li><a href="javascript:void(0);" data-level="small">240p</a></li><li><a href="javascript:void(0);" data-level="default">automático</a></li></ul></div></div><div class="plt_sub sub-empty"><div class="plt_sub_top"><span>legenda</span><button class="plt_sub_back" title="voltar"><b></b>voltar</button><button class="plt_sub_edit">editar</button></div><div class="sep"></div><div class="plt_sub_exb"><label><input type="checkbox" id="js-show-sub" class="chk"><span>exibir</span></label><label><input type="checkbox" id="js-over-sub" class="chk"><span>em cima do vídeo</span></label></div><div class="sep"></div><div class="plt_sub_lan" style="display: none;"><span>idioma padrão</span><button data-lang="t" class="plt_bt_t plt_sub_tra"><b></b>tradução</button><button data-lang="o" class="plt_bt_t plt_sub_ori on"><b></b>original</button></div></div></div><div class="pl_videos"><div class="pl_videos_search"><form id="js-video-search-submit"><input type="text" class="pl_videos_inp" value=""><button type="submit" class="pl_videos_sub"><b></b>Buscar</button></form><button class="pl_videos_ext">Sair</button></div><div class="pl_videos_list"><ul></ul></div></div><div class="pl_end"><button class="pl_end_repeat">Assistir novamente</button><strong class="pl_end_notfound hidden">Não encontramos vídeo para essa música =(</strong><div class="pl_end_next">'+(this.videos.length>++this.videoIndex?'<span></span><button class="pl_end_stop" style="display: none;">Parar</button><div class="pl_end_thumb" data-id="'+this.videos[this.videoIndex].id+'"><img src="//i.ytimg.com/vi/'+this.videos[this.videoIndex].id+'/0.jpg" alt="" width="220" height="165"><div class="pl_end_song">'+this.videos[this.videoIndex].name+"</div></div>":"")+'</div></div><button class="pl_bt_lyrics">ver letra</button><button class="pl_bt_sub">enviar legenda</button><button class="pl_bt_close" title="fechar"><b></b>fechar</button>'},m.prototype.getVideoListTemplate=function(){for(var e="",t=0;t<this.videos.length;t++)e+='<li><a href="javascript:void(0);" data-id="'+this.videos[t].id+'"><b><img src="https://i.ytimg.com/vi/'+this.videos[t].id+'/default.jpg" alt=""></b><span>'+this.videos[t].name+"</span><small>"+formatNumber(this.videos[t].views,0,".","","","","","")+" exibições</small></a></li>";return e}}(window,jQuery),UserStorage.prototype.get=function(e){return void 0!==this.base.storage[e]?this.base.storage[e]:{}},UserStorage.prototype.set=function(e,t){0===Object.keys(t).length?delete this.base.storage[e]:this.base.storage[e]=t,this.base.save()},SongStorage.prototype.init=function(){var e,t=this.userConfig.get(this.userConfigKey),s=this.userConfig.get(this.cifraKey);this.config={font:{hash:SS.song.hash.config.font.hash,defaultValue:SS.song.font.fontSizes.normal,type:"user"},bodyChords:{hash:SS.song.hash.config.bodyChords.hash,defaultValue:!1,type:"song"},footerChords:{hash:SS.song.hash.config.footerChords.hash,defaultValue:!0,type:"user"},tabs:{hash:SS.song.hash.config.tabs.hash,defaultValue:!0,type:"user"},leftHanded:{hash:SS.song.hash.config.leftHanded.hash,defaultValue:!1,type:"user"},video:{hash:SS.song.hash.config.video.hash,defaultValue:!1,type:"song"},columns:{hash:SS.song.hash.config.columns.hash,defaultValue:!1,type:"song"}};for(e in t)void 0===SS.song.hash.base.get(e)&&SS.song.hash.set(SS.song.hash.getKeyByHash(e),t[e]);for(e in s)void 0===SS.song.hash.base.get(e)&&SS.song.hash.set(SS.song.hash.getKeyByHash(e),s[e]);SS.song.hash.base.updateUrl(),SS.song.hash.base.get("autoplay")===!0&&this.removeConfig(this.userConfigKey,"autoplay")},SongStorage.prototype.setConfig=function(e,t,s){var o=this.userConfig.get("user"===e?this.userConfigKey:this.cifraKey);o[t]=s,this.userConfig.set("user"===e?this.userConfigKey:this.cifraKey,o)},SongStorage.prototype.removeConfig=function(e,t){var s=this.userConfig.get("user"===e?this.userConfigKey:this.cifraKey);delete s[t],this.userConfig.set("user"===e?this.userConfigKey:this.cifraKey,s)},SongStorage.prototype.set=function(e,t){if(void 0===this.config[e])return!1;var s=!1;s=Array.isArray(this.config[e].defaultValue)?-1!==this.config[e].defaultValue.indexOf(t):this.config[e].defaultValue===t,s?this.removeConfig(this.config[e].type,this.config[e].hash):this.setConfig(this.config[e].type,this.config[e].hash,t)},SongHash.prototype.config={video:{hash:"autoplay",defaultValue:!1,ignoredInstruments:[]},capo:{hash:"capo",defaultValue:0,ignoredInstruments:["keyboard","cavaco","bass","drums","harmonica"]},font:{hash:"font",defaultValue:void 0,ignoredInstruments:[]},tone:{hash:"tone",defaultValue:0,ignoredInstruments:["bass","drums","harmonica"]},tuning:{hash:"tuning",defaultValue:0,ignoredInstruments:["keyboard","cavaco","bass","drums","harmonica"]},columns:{hash:"columns",defaultValue:!1,ignoredInstruments:["bass","drums","harmonica"]},bodyChords:{hash:"body-chords",defaultValue:!1,ignoredInstruments:["bass","drums","harmonica"]},footerChords:{hash:"footer-chords",defaultValue:!0,ignoredInstruments:["bass","drums","harmonica"]},tabs:{hash:"tabs",defaultValue:!0,ignoredInstruments:["keyboard","cavaco","bass","drums","harmonica"]
},leftHanded:{hash:"left-handed",defaultValue:!1,ignoredInstruments:["keyboard","drums","harmonica"]},instrument:{hash:"instrument",defaultValue:"guitar",ignoredInstruments:[]}},SongHash.prototype.init=function(){var e=this;e.config.font.defaultValue=SS.song.font.fontSizes.normal;var t,s=!1;if(t=e.base.get("electric-guitar"),void 0!==t&&(e.base.remove("electric-guitar"),e.base.add("instrument","electric-guitar"),e.base.updateUrl()),t=e.base.get("keyboard"),void 0!==t&&(e.base.remove("keyboard"),e.base.add("instrument","keyboard"),e.base.updateUrl()),t=e.base.get("cavaco"),void 0!==t&&(e.base.remove("cavaco"),e.base.add("instrument","cavaco"),e.base.updateUrl()),t=e.base.get(e.config.instrument.hash),void 0!==t&&(SS.song.versions.setSelectedInstrument(t),s=!0),t=e.base.get(e.config.video.hash),void 0!==t&&"true"===t.toString()&&SS.song.startVideoLesson(!0),t=e.base.get(e.config.font.hash),void 0!==t&&(SS.song.font.fontSize=parseInt(t),SS.song.font.updateSize()),t=e.base.get(e.config.tone.hash),void 0!==t&&0!==t){var o=parseInt(t);SS.song.key.settings.invisibleCapoTuning&&(o+=SS.song.capo.settings.originalValue-SS.songCore.tuning.getIndex(SS.songCore.tuning.settings.originalValue)),SS.song.key.setValue(o).done(function(){SS.song.chordsUI.updateSongContent()})}t=e.base.get(e.config.tuning.hash),void 0!==t&&(SS.song.tuning.setValue(t),s=!0),t=e.base.get(e.config.capo.hash),void 0!==t&&0!==t&&(SS.song.capo.setValue(parseInt(t)),s=!0),t=e.base.get(e.config.columns.hash),void 0!==t&&(t="true"===t.toString(),SS.song.displayHandler.splitColumns(t),$(SS.song.displayHandler.settings.selectors.columnsCheck).prop("checked",t),s=!0),t=e.base.get(e.config.bodyChords.hash),void 0!==t&&(t="true"===t.toString(),SS.song.displayHandler.showChordsBody(t),$(SS.song.displayHandler.settings.selectors.chordsBodyCheck).prop("checked",t),s=!0),t=e.base.get(e.config.footerChords.hash),void 0!==t&&(t="true"===t.toString(),SS.song.displayHandler.showChordsFooter(t),$(SS.song.displayHandler.settings.selectors.chordsFooterCheck).prop("checked",t),s=!0),t=e.base.get(e.config.tabs.hash),void 0!==t&&(t="true"===t.toString(),SS.song.displayHandler.showTabs(t),$(SS.song.displayHandler.settings.selectors.tabsCheck).prop("checked",t)),t=e.base.get(e.config.leftHanded.hash),void 0!==t&&(t="true"===t.toString(),SS.song.displayHandler.setLeftHanded(t),$(SS.song.displaHandler.settings.selectors.leftHandedCheck).prop("checked",t),s=!0),s&&(SS.song.chordsUI.updateChordsHtml(),SS.song.chordsUI.buildHeader()),this.updatePrintLink()},SongHash.prototype.resetFontValue=function(){this.config.font.defaultValue=SS.song.font.fontSizes.normal},SongHash.prototype.updatePrintLink=function(){var e=$("#js-print_link"),t=e.attr("href");e.attr("href",t.replace(/#.*|$/,this.base.getUrlHash().trim()))},SongHash.prototype.set=function(e,t){if(void 0===this.config[e]||-1!==this.config[e].ignoredInstruments.indexOf(this.instrumentSlug))return!1;var s=!1;s=Array.isArray(this.config[e].defaultValue)?-1!==this.config[e].defaultValue.indexOf(t):this.config[e].defaultValue===t,s?this.base.remove(this.config[e].hash):this.base.add(this.config[e].hash,t),this.updatePrintLink()},SongHash.prototype.getKeyByHash=function(e){var t=null;return $.each(this.config,function(s,o){return o.hash===e?(t=s,!1):void 0}),t};